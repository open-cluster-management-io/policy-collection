apiVersion: policy.open-cluster-management.io/v1
kind: PolicyGenerator
metadata:
  name: kyverno-multitenancy-policyset
placementBindingDefaults:
  name: kyverno-multitenancy-policyset
policyDefaults:
  configurationPolicyAnnotations: {"policy.open-cluster-management.io/disable-templates": "true"}
  categories:
    - AC Access Control
  controls: 
    - AC-3 Access Enforcement
  namespace: policies
  remediationAction: enforce
  severity: medium
  policySets:
    - kyverno-multitenancy-policyset
  standards:
    - NIST SP 800-53
policies:
# hub policies
- name: disallow-placementrules
  disabled: false
  manifests:
    - path: ../input/multitenancy/disallowplacementrules
  policySets:
    - kyverno-multitenancy-hub-policyset
- name: gen-managed-clusterset-binding
  disabled: false
  manifests:
    - path: ../input/multitenancy/generateManagedClusterSetBinding
  policySets:
    - kyverno-multitenancy-hub-policyset
- name: gen-placement-rules
  disabled: false
  manifests:
    - path: ../input/multitenancy/generatePlacementRules
  policySets:
    - kyverno-multitenancy-hub-policyset
- name: generate-all
  disabled: false
  manifests:
    - path: ../input/multitenancy/generateall
  policySets:
    - kyverno-multitenancy-hub-policyset
- name: validate-placement
  disabled: false
  manifests:
    - path: ../input/multitenancy/validateplacement
  policySets:
    - kyverno-multitenancy-hub-policyset
- name: preventupdatesappproject
  disabled: false
  manifests:
    - path: ../input/multitenancy/preventupdatesappproject
  policySets:
    - kyverno-multitenancy-hub-policyset
- name: team-restrictions
  disabled: false
  manifests:
    - path: ../input/multitenancy/restrictions
  policySets:
    - kyverno-multitenancy-hub-policyset
# end hub policies
# managed cluster policies
- name: add-labels-to-tenant
  disabled: false
  manifests:
    - path: ../input/multitenancy/addlabelstotenant
- name: gen-argocdpersmissions
  disabled: false
  manifests:
    - path: ../input/multitenancy/generateargocdpersmissions
- name: add-job-ttl
  disabled: false
  manifests:
    - path: ../input/multitenancy/other
- name: team-sharedresources
  disabled: false
  manifests:
    - path: ../input/multitenancy/sharedresources
- name: team-validate-ns
  disabled: false
  manifests:
    - path: ../input/multitenancy/validatens
# end managed cluster policies
policySets:
  - description: kyverno-multitenancy-hub-policyset to apply set of kyverno-policies on the open cluster management hub.
    name: kyverno-multitenancy-hub-policyset
    placement:
      placementPath: placement-hub.yaml
  - description: kyverno-multitenancy-policyset to apply set of kyverno-policies.
    name: kyverno-multitenancy-policyset
    placement:
      placementPath: placement.yaml

