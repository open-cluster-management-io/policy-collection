# This policy assumes that the Compliance Operator is installed and running on
# the managed clusters. It deploys a scan that will check the master and worker
# nodes and verifies for compliance with the E8 (Essential 8) security profile.
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-e8-scan
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-6 Configuration Settings
    integrityshield.io/message: IyBUaGlzIHBvbGljeSBhc3N1bWVzIHRoYXQgdGhlIENvbXBsaWFuY2UgT3BlcmF0b3IgaXMgaW5zdGFsbGVkIGFuZCBydW5uaW5nIG9uCiMgdGhlIG1hbmFnZWQgY2x1c3RlcnMuIEl0IGRlcGxveXMgYSBzY2FuIHRoYXQgd2lsbCBjaGVjayB0aGUgbWFzdGVyIGFuZCB3b3JrZXIKIyBub2RlcyBhbmQgdmVyaWZpZXMgZm9yIGNvbXBsaWFuY2Ugd2l0aCB0aGUgRTggKEVzc2VudGlhbCA4KSBzZWN1cml0eSBwcm9maWxlLgphcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUG9saWN5Cm1ldGFkYXRhOgogIG5hbWU6IHBvbGljeS1lOC1zY2FuCiAgYW5ub3RhdGlvbnM6CiAgICBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vc3RhbmRhcmRzOiBOSVNUIFNQIDgwMC01MwogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NhdGVnb3JpZXM6IENNIENvbmZpZ3VyYXRpb24gTWFuYWdlbWVudAogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NvbnRyb2xzOiBDTS02IENvbmZpZ3VyYXRpb24gU2V0dGluZ3MKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogaW5mb3JtCiAgZGlzYWJsZWQ6IGZhbHNlCiAgcG9saWN5LXRlbXBsYXRlczoKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBjb21wbGlhbmNlLWU4LXNjYW4KICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlICMgdGhpcyB0ZW1wbGF0ZSBjcmVhdGVzIFNjYW5TZXR0aW5nQmluZGluZzplOAogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogU2NhblNldHRpbmdCaW5kaW5nCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogZTgKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiBvcGVuc2hpZnQtY29tcGxpYW5jZQogICAgICAgICAgICAgICAgcHJvZmlsZXM6CiAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICAgICAga2luZDogUHJvZmlsZQogICAgICAgICAgICAgICAgICAgIG5hbWU6IG9jcDQtZTgKICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogY29tcGxpYW5jZS5vcGVuc2hpZnQuaW8vdjFhbHBoYTEKICAgICAgICAgICAgICAgICAgICBraW5kOiBQcm9maWxlCiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmhjb3M0LWU4CiAgICAgICAgICAgICAgICBzZXR0aW5nc1JlZjoKICAgICAgICAgICAgICAgICAgYXBpR3JvdXA6IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICAgIGtpbmQ6IFNjYW5TZXR0aW5nCiAgICAgICAgICAgICAgICAgIG5hbWU6IGRlZmF1bHQKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBjb21wbGlhbmNlLXN1aXRlLWU4CiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBpbmZvcm0KICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZSAjIHRoaXMgdGVtcGxhdGUgY2hlY2tzIGlmIHNjYW4gaGFzIGNvbXBsZXRlZCBieSBjaGVja2luZyB0aGUgc3RhdHVzIGZpZWxkCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBDb21wbGlhbmNlU3VpdGUKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBlOAogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IG9wZW5zaGlmdC1jb21wbGlhbmNlCiAgICAgICAgICAgICAgICBzdGF0dXM6CiAgICAgICAgICAgICAgICAgIHBoYXNlOiBET05FCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogY29tcGxpYW5jZS1zdWl0ZS1lOC1yZXN1bHRzCiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBpbmZvcm0KICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0bm90aGF2ZSAjIHRoaXMgdGVtcGxhdGUgcmVwb3J0cyB0aGUgcmVzdWx0cyBmb3Igc2NhbiBzdWl0ZTogZTggYnkgbG9va2luZyBhdCBDb21wbGlhbmNlQ2hlY2tSZXN1bHQgQ1JzCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBDb21wbGlhbmNlQ2hlY2tSZXN1bHQKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IG9wZW5zaGlmdC1jb21wbGlhbmNlCiAgICAgICAgICAgICAgICAgIGxhYmVsczoKICAgICAgICAgICAgICAgICAgICBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby9jaGVjay1zdGF0dXM6IEZBSUwKICAgICAgICAgICAgICAgICAgICBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby9zdWl0ZTogZTgKLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LWU4LXNjYW4KICBhbm5vdGF0aW9uczoge30KcGxhY2VtZW50UmVmOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktZTgtc2NhbgogIGtpbmQ6IFBsYWNlbWVudFJ1bGUKICBhcGlHcm91cDogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwpzdWJqZWN0czoKICAtIG5hbWU6IHBvbGljeS1lOC1zY2FuCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LWU4LXNjYW4KICBhbm5vdGF0aW9uczoge30Kc3BlYzoKICBjbHVzdGVyQ29uZGl0aW9uczoKICAgIC0gc3RhdHVzOiAiVHJ1ZSIKICAgICAgdHlwZTogTWFuYWdlZENsdXN0ZXJDb25kaXRpb25BdmFpbGFibGUKICBjbHVzdGVyU2VsZWN0b3I6CiAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAtIHtrZXk6IHZlbmRvciwgb3BlcmF0b3I6IEluLCB2YWx1ZXM6IFsiT3BlblNoaWZ0Il19Cg==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhGOFNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaUI0b0wvUjAwd3dhbFNrdENZMU9aV0doWU0rSzc2cmhGTjJISQpQUkRBWldjWWx3WmV4NEQveU4zZTVObXNtb0gxcFFndXJFRSt3K0l2RjR1Q0F6SE5Dc1dhSjRWZkJneHZmOHZKCjg2eCs4U1ordUxTY1pRQ2ZwUm1pQUFwSTBlTS9pYWRyRk5LRzdKRzRzb2Rmb1JGRHNLNXJRNCs4UEdTQldjd0EKNUJ0YStKQncreFFBd0h5Tjh3ZHRzOWlqVGV0Szd5Y1Jsdld0ZFNLcUp2U055djQ1ZXFxbDA0Um5GR2dsTGxWOAo2RTJWTlNXbXpMb1VMbVptN1ZPRUhmdGl5SnlzZ29xSDRGY3NDS3ZjcE5aOTlnK3RRTzRuaU5aRHJXVHpFU3kxCklKYmwvK2tuOEFCbnRzSE9yK2E4MmFHd1UrZ2M2S1ZVdElZWitnR2lkUys1alNnVS82NVlXY2tYNSs3bHlVWVcKMEd2Wlg1cDlyS284L0lQQU45cHlwclRHV3UzVC9OdGVXbDlNdlk1WEtzS0hpZXhORzVQNVZLMXlMSms4V050NAoxZ3h1dlFJaTJ3dzhhVEZHaXZNaStBYnFwY0xQQ3hDTUN6KzJKM3dXOTkxYmNQcjNsRlVxUlR2YjlKMXNCODlVCklsWE9QdXZBZHRZTUNIa3V2M0s0SVhOZ1ZxVUN5clZiRlE9PQo9SVdYbQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: compliance-e8-scan
        spec:
          remediationAction: inform
          severity: high
          object-templates:
            - complianceType: musthave # this template creates ScanSettingBinding:e8
              objectDefinition:
                apiVersion: compliance.openshift.io/v1alpha1
                kind: ScanSettingBinding
                metadata:
                  name: e8
                  namespace: openshift-compliance
                profiles:
                  - apiGroup: compliance.openshift.io/v1alpha1
                    kind: Profile
                    name: ocp4-e8
                  - apiGroup: compliance.openshift.io/v1alpha1
                    kind: Profile
                    name: rhcos4-e8
                settingsRef:
                  apiGroup: compliance.openshift.io/v1alpha1
                  kind: ScanSetting
                  name: default
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: compliance-suite-e8
        spec:
          remediationAction: inform
          severity: high
          object-templates:
            - complianceType: musthave # this template checks if scan has completed by checking the status field
              objectDefinition:
                apiVersion: compliance.openshift.io/v1alpha1
                kind: ComplianceSuite
                metadata:
                  name: e8
                  namespace: openshift-compliance
                status:
                  phase: DONE
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: compliance-suite-e8-results
        spec:
          remediationAction: inform
          severity: high
          object-templates:
            - complianceType: mustnothave # this template reports the results for scan suite: e8 by looking at ComplianceCheckResult CRs
              objectDefinition:
                apiVersion: compliance.openshift.io/v1alpha1
                kind: ComplianceCheckResult
                metadata:
                  namespace: openshift-compliance
                  labels:
                    compliance.openshift.io/check-status: FAIL
                    compliance.openshift.io/suite: e8
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-e8-scan
  annotations: {integrityshield.io/message: IyBUaGlzIHBvbGljeSBhc3N1bWVzIHRoYXQgdGhlIENvbXBsaWFuY2UgT3BlcmF0b3IgaXMgaW5zdGFsbGVkIGFuZCBydW5uaW5nIG9uCiMgdGhlIG1hbmFnZWQgY2x1c3RlcnMuIEl0IGRlcGxveXMgYSBzY2FuIHRoYXQgd2lsbCBjaGVjayB0aGUgbWFzdGVyIGFuZCB3b3JrZXIKIyBub2RlcyBhbmQgdmVyaWZpZXMgZm9yIGNvbXBsaWFuY2Ugd2l0aCB0aGUgRTggKEVzc2VudGlhbCA4KSBzZWN1cml0eSBwcm9maWxlLgphcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUG9saWN5Cm1ldGFkYXRhOgogIG5hbWU6IHBvbGljeS1lOC1zY2FuCiAgYW5ub3RhdGlvbnM6CiAgICBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vc3RhbmRhcmRzOiBOSVNUIFNQIDgwMC01MwogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NhdGVnb3JpZXM6IENNIENvbmZpZ3VyYXRpb24gTWFuYWdlbWVudAogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NvbnRyb2xzOiBDTS02IENvbmZpZ3VyYXRpb24gU2V0dGluZ3MKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogaW5mb3JtCiAgZGlzYWJsZWQ6IGZhbHNlCiAgcG9saWN5LXRlbXBsYXRlczoKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBjb21wbGlhbmNlLWU4LXNjYW4KICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlICMgdGhpcyB0ZW1wbGF0ZSBjcmVhdGVzIFNjYW5TZXR0aW5nQmluZGluZzplOAogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogU2NhblNldHRpbmdCaW5kaW5nCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogZTgKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiBvcGVuc2hpZnQtY29tcGxpYW5jZQogICAgICAgICAgICAgICAgcHJvZmlsZXM6CiAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICAgICAga2luZDogUHJvZmlsZQogICAgICAgICAgICAgICAgICAgIG5hbWU6IG9jcDQtZTgKICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogY29tcGxpYW5jZS5vcGVuc2hpZnQuaW8vdjFhbHBoYTEKICAgICAgICAgICAgICAgICAgICBraW5kOiBQcm9maWxlCiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmhjb3M0LWU4CiAgICAgICAgICAgICAgICBzZXR0aW5nc1JlZjoKICAgICAgICAgICAgICAgICAgYXBpR3JvdXA6IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICAgIGtpbmQ6IFNjYW5TZXR0aW5nCiAgICAgICAgICAgICAgICAgIG5hbWU6IGRlZmF1bHQKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBjb21wbGlhbmNlLXN1aXRlLWU4CiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBpbmZvcm0KICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZSAjIHRoaXMgdGVtcGxhdGUgY2hlY2tzIGlmIHNjYW4gaGFzIGNvbXBsZXRlZCBieSBjaGVja2luZyB0aGUgc3RhdHVzIGZpZWxkCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBDb21wbGlhbmNlU3VpdGUKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBlOAogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IG9wZW5zaGlmdC1jb21wbGlhbmNlCiAgICAgICAgICAgICAgICBzdGF0dXM6CiAgICAgICAgICAgICAgICAgIHBoYXNlOiBET05FCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogY29tcGxpYW5jZS1zdWl0ZS1lOC1yZXN1bHRzCiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBpbmZvcm0KICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0bm90aGF2ZSAjIHRoaXMgdGVtcGxhdGUgcmVwb3J0cyB0aGUgcmVzdWx0cyBmb3Igc2NhbiBzdWl0ZTogZTggYnkgbG9va2luZyBhdCBDb21wbGlhbmNlQ2hlY2tSZXN1bHQgQ1JzCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBDb21wbGlhbmNlQ2hlY2tSZXN1bHQKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IG9wZW5zaGlmdC1jb21wbGlhbmNlCiAgICAgICAgICAgICAgICAgIGxhYmVsczoKICAgICAgICAgICAgICAgICAgICBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby9jaGVjay1zdGF0dXM6IEZBSUwKICAgICAgICAgICAgICAgICAgICBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby9zdWl0ZTogZTgKLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LWU4LXNjYW4KICBhbm5vdGF0aW9uczoge30KcGxhY2VtZW50UmVmOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktZTgtc2NhbgogIGtpbmQ6IFBsYWNlbWVudFJ1bGUKICBhcGlHcm91cDogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwpzdWJqZWN0czoKICAtIG5hbWU6IHBvbGljeS1lOC1zY2FuCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LWU4LXNjYW4KICBhbm5vdGF0aW9uczoge30Kc3BlYzoKICBjbHVzdGVyQ29uZGl0aW9uczoKICAgIC0gc3RhdHVzOiAiVHJ1ZSIKICAgICAgdHlwZTogTWFuYWdlZENsdXN0ZXJDb25kaXRpb25BdmFpbGFibGUKICBjbHVzdGVyU2VsZWN0b3I6CiAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAtIHtrZXk6IHZlbmRvciwgb3BlcmF0b3I6IEluLCB2YWx1ZXM6IFsiT3BlblNoaWZ0Il19Cg==, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhGOFNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaUI0b0wvUjAwd3dhbFNrdENZMU9aV0doWU0rSzc2cmhGTjJISQpQUkRBWldjWWx3WmV4NEQveU4zZTVObXNtb0gxcFFndXJFRSt3K0l2RjR1Q0F6SE5Dc1dhSjRWZkJneHZmOHZKCjg2eCs4U1ordUxTY1pRQ2ZwUm1pQUFwSTBlTS9pYWRyRk5LRzdKRzRzb2Rmb1JGRHNLNXJRNCs4UEdTQldjd0EKNUJ0YStKQncreFFBd0h5Tjh3ZHRzOWlqVGV0Szd5Y1Jsdld0ZFNLcUp2U055djQ1ZXFxbDA0Um5GR2dsTGxWOAo2RTJWTlNXbXpMb1VMbVptN1ZPRUhmdGl5SnlzZ29xSDRGY3NDS3ZjcE5aOTlnK3RRTzRuaU5aRHJXVHpFU3kxCklKYmwvK2tuOEFCbnRzSE9yK2E4MmFHd1UrZ2M2S1ZVdElZWitnR2lkUys1alNnVS82NVlXY2tYNSs3bHlVWVcKMEd2Wlg1cDlyS284L0lQQU45cHlwclRHV3UzVC9OdGVXbDlNdlk1WEtzS0hpZXhORzVQNVZLMXlMSms4V050NAoxZ3h1dlFJaTJ3dzhhVEZHaXZNaStBYnFwY0xQQ3hDTUN6KzJKM3dXOTkxYmNQcjNsRlVxUlR2YjlKMXNCODlVCklsWE9QdXZBZHRZTUNIa3V2M0s0SVhOZ1ZxVUN5clZiRlE9PQo9SVdYbQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
placementRef:
  name: placement-policy-e8-scan
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-e8-scan
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-e8-scan
  annotations: {integrityshield.io/message: IyBUaGlzIHBvbGljeSBhc3N1bWVzIHRoYXQgdGhlIENvbXBsaWFuY2UgT3BlcmF0b3IgaXMgaW5zdGFsbGVkIGFuZCBydW5uaW5nIG9uCiMgdGhlIG1hbmFnZWQgY2x1c3RlcnMuIEl0IGRlcGxveXMgYSBzY2FuIHRoYXQgd2lsbCBjaGVjayB0aGUgbWFzdGVyIGFuZCB3b3JrZXIKIyBub2RlcyBhbmQgdmVyaWZpZXMgZm9yIGNvbXBsaWFuY2Ugd2l0aCB0aGUgRTggKEVzc2VudGlhbCA4KSBzZWN1cml0eSBwcm9maWxlLgphcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUG9saWN5Cm1ldGFkYXRhOgogIG5hbWU6IHBvbGljeS1lOC1zY2FuCiAgYW5ub3RhdGlvbnM6CiAgICBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vc3RhbmRhcmRzOiBOSVNUIFNQIDgwMC01MwogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NhdGVnb3JpZXM6IENNIENvbmZpZ3VyYXRpb24gTWFuYWdlbWVudAogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NvbnRyb2xzOiBDTS02IENvbmZpZ3VyYXRpb24gU2V0dGluZ3MKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogaW5mb3JtCiAgZGlzYWJsZWQ6IGZhbHNlCiAgcG9saWN5LXRlbXBsYXRlczoKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBjb21wbGlhbmNlLWU4LXNjYW4KICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlICMgdGhpcyB0ZW1wbGF0ZSBjcmVhdGVzIFNjYW5TZXR0aW5nQmluZGluZzplOAogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogU2NhblNldHRpbmdCaW5kaW5nCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogZTgKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiBvcGVuc2hpZnQtY29tcGxpYW5jZQogICAgICAgICAgICAgICAgcHJvZmlsZXM6CiAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICAgICAga2luZDogUHJvZmlsZQogICAgICAgICAgICAgICAgICAgIG5hbWU6IG9jcDQtZTgKICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogY29tcGxpYW5jZS5vcGVuc2hpZnQuaW8vdjFhbHBoYTEKICAgICAgICAgICAgICAgICAgICBraW5kOiBQcm9maWxlCiAgICAgICAgICAgICAgICAgICAgbmFtZTogcmhjb3M0LWU4CiAgICAgICAgICAgICAgICBzZXR0aW5nc1JlZjoKICAgICAgICAgICAgICAgICAgYXBpR3JvdXA6IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICAgIGtpbmQ6IFNjYW5TZXR0aW5nCiAgICAgICAgICAgICAgICAgIG5hbWU6IGRlZmF1bHQKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBjb21wbGlhbmNlLXN1aXRlLWU4CiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBpbmZvcm0KICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZSAjIHRoaXMgdGVtcGxhdGUgY2hlY2tzIGlmIHNjYW4gaGFzIGNvbXBsZXRlZCBieSBjaGVja2luZyB0aGUgc3RhdHVzIGZpZWxkCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBDb21wbGlhbmNlU3VpdGUKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBlOAogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IG9wZW5zaGlmdC1jb21wbGlhbmNlCiAgICAgICAgICAgICAgICBzdGF0dXM6CiAgICAgICAgICAgICAgICAgIHBoYXNlOiBET05FCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogY29tcGxpYW5jZS1zdWl0ZS1lOC1yZXN1bHRzCiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBpbmZvcm0KICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0bm90aGF2ZSAjIHRoaXMgdGVtcGxhdGUgcmVwb3J0cyB0aGUgcmVzdWx0cyBmb3Igc2NhbiBzdWl0ZTogZTggYnkgbG9va2luZyBhdCBDb21wbGlhbmNlQ2hlY2tSZXN1bHQgQ1JzCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGNvbXBsaWFuY2Uub3BlbnNoaWZ0LmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBDb21wbGlhbmNlQ2hlY2tSZXN1bHQKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IG9wZW5zaGlmdC1jb21wbGlhbmNlCiAgICAgICAgICAgICAgICAgIGxhYmVsczoKICAgICAgICAgICAgICAgICAgICBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby9jaGVjay1zdGF0dXM6IEZBSUwKICAgICAgICAgICAgICAgICAgICBjb21wbGlhbmNlLm9wZW5zaGlmdC5pby9zdWl0ZTogZTgKLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LWU4LXNjYW4KICBhbm5vdGF0aW9uczoge30KcGxhY2VtZW50UmVmOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktZTgtc2NhbgogIGtpbmQ6IFBsYWNlbWVudFJ1bGUKICBhcGlHcm91cDogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwpzdWJqZWN0czoKICAtIG5hbWU6IHBvbGljeS1lOC1zY2FuCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LWU4LXNjYW4KICBhbm5vdGF0aW9uczoge30Kc3BlYzoKICBjbHVzdGVyQ29uZGl0aW9uczoKICAgIC0gc3RhdHVzOiAiVHJ1ZSIKICAgICAgdHlwZTogTWFuYWdlZENsdXN0ZXJDb25kaXRpb25BdmFpbGFibGUKICBjbHVzdGVyU2VsZWN0b3I6CiAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAtIHtrZXk6IHZlbmRvciwgb3BlcmF0b3I6IEluLCB2YWx1ZXM6IFsiT3BlblNoaWZ0Il19Cg==, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhGOFNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaUI0b0wvUjAwd3dhbFNrdENZMU9aV0doWU0rSzc2cmhGTjJISQpQUkRBWldjWWx3WmV4NEQveU4zZTVObXNtb0gxcFFndXJFRSt3K0l2RjR1Q0F6SE5Dc1dhSjRWZkJneHZmOHZKCjg2eCs4U1ordUxTY1pRQ2ZwUm1pQUFwSTBlTS9pYWRyRk5LRzdKRzRzb2Rmb1JGRHNLNXJRNCs4UEdTQldjd0EKNUJ0YStKQncreFFBd0h5Tjh3ZHRzOWlqVGV0Szd5Y1Jsdld0ZFNLcUp2U055djQ1ZXFxbDA0Um5GR2dsTGxWOAo2RTJWTlNXbXpMb1VMbVptN1ZPRUhmdGl5SnlzZ29xSDRGY3NDS3ZjcE5aOTlnK3RRTzRuaU5aRHJXVHpFU3kxCklKYmwvK2tuOEFCbnRzSE9yK2E4MmFHd1UrZ2M2S1ZVdElZWitnR2lkUys1alNnVS82NVlXY2tYNSs3bHlVWVcKMEd2Wlg1cDlyS284L0lQQU45cHlwclRHV3UzVC9OdGVXbDlNdlk1WEtzS0hpZXhORzVQNVZLMXlMSms4V050NAoxZ3h1dlFJaTJ3dzhhVEZHaXZNaStBYnFwY0xQQ3hDTUN6KzJKM3dXOTkxYmNQcjNsRlVxUlR2YjlKMXNCODlVCklsWE9QdXZBZHRZTUNIa3V2M0s0SVhOZ1ZxVUN5clZiRlE9PQo9SVdYbQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: vendor, operator: In, values: ["OpenShift"]}
