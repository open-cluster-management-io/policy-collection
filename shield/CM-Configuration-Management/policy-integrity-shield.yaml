apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-integrity-shield
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-5 Access Restrictions for Change
    integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOgogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3N0YW5kYXJkczogTklTVCBTUCA4MDAtNTMKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jYXRlZ29yaWVzOiBDTSBDb25maWd1cmF0aW9uIE1hbmFnZW1lbnQKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogQ00tNSBBY2Nlc3MgUmVzdHJpY3Rpb25zIGZvciBDaGFuZ2UKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogaW5mb3JtCiAgZGlzYWJsZWQ6IGZhbHNlCiAgcG9saWN5LXRlbXBsYXRlczoKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1uYW1lc3BhY2UKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBIaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBraW5kOiBOYW1lc3BhY2UKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IHYxCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1vZwogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IG9wZXJhdG9ycy5jb3Jlb3MuY29tL3YxCiAgICAgICAgICAgICAgICBraW5kOiBPcGVyYXRvckdyb3VwCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LW9wZXJhdG9yLWdyb3VwCiAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgICAgICAgICAgICAgIHNwZWM6CiAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWVzcGFjZXM6CiAgICAgICAgICAgICAgICAgICAgLSBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yLXN5c3RlbQogICAgLSBvYmplY3REZWZpbml0aW9uOgogICAgICAgIGFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQogICAgICAgIGtpbmQ6IENvbmZpZ3VyYXRpb25Qb2xpY3kKICAgICAgICBtZXRhZGF0YToKICAgICAgICAgIG5hbWU6IHBvbGljeS1pbnRlZ3JpdHktc2hpZWxkLXN1YgogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IG9wZXJhdG9ycy5jb3Jlb3MuY29tL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBTdWJzY3JpcHRpb24KICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yCiAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgICAgICAgICAgICAgIHNwZWM6CiAgICAgICAgICAgICAgICAgIGNoYW5uZWw6IGFscGhhCiAgICAgICAgICAgICAgICAgIGluc3RhbGxQbGFuQXBwcm92YWw6IEF1dG9tYXRpYwogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yCiAgICAgICAgICAgICAgICAgIHNvdXJjZTogY29tbXVuaXR5LW9wZXJhdG9ycwogICAgICAgICAgICAgICAgICBzb3VyY2VOYW1lc3BhY2U6IG9wZW5zaGlmdC1tYXJrZXRwbGFjZQogICAgICAgICAgICAgICAgICBzdGFydGluZ0NTVjogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci52MC4xLjMKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1jcgogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGFwaXMuaW50ZWdyaXR5c2hpZWxkLmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBJbnRlZ3JpdHlTaGllbGQKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLXNlcnZlcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBsb2dnZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHF1YXkuaW8vb3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQvaW50ZWdyaXR5LXNoaWVsZC1sb2dnaW5nOjAuMS4zCiAgICAgICAgICAgICAgICAgIHNlcnZlcjoKICAgICAgICAgICAgICAgICAgICBpbWFnZTogcXVheS5pby9vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC9pbnRlZ3JpdHktc2hpZWxkLXNlcnZlcjowLjEuMwogICAgICAgICAgICAgICAgICBhZmZpbml0eToge30KICAgICAgICAgICAgICAgICAgc2hpZWxkQ29uZmlnOgogICAgICAgICAgICAgICAgICAgIHZlcmlmeVR5cGU6IHBncCAjIHg1MDkKICAgICAgICAgICAgICAgICAgICBpU2hpZWxkQWRtaW5Vc2VyTmFtZTogInN5c3RlbTpzZXJ2aWNlYWNjb3VudDpvcGVuLWNsdXN0ZXItbWFuYWdlbWVudC1hZ2VudC1hZGRvbjprbHVzdGVybGV0LWFkZG9uLXBvbGljeWN0cmwiCiAgICAgICAgICAgICAgICAgICAgaW5TY29wZU5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZToKICAgICAgICAgICAgICAgICAgICAgICAgLSAiKiIKICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gImt1YmUtKiIKICAgICAgICAgICAgICAgICAgICAgICAgLSAib3BlbnNoaWZ0LSoiCiAgICAgICAgICAgICAgICAgIHNpZ25lckNvbmZpZzoKICAgICAgICAgICAgICAgICAgICBwb2xpY2llczoKICAgICAgICAgICAgICAgICAgICAgIC0gbmFtZXNwYWNlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICIqIgogICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICAgIC0gc2NvcGU6ICJDbHVzdGVyIgogICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgLSBuYW1lOiAiU2FtcGxlU2lnbmVyIgogICAgICAgICAgICAgICAgICAgICAgICBrZXlDb25maWc6IHNhbXBsZS1zaWduZXIta2V5Y29uZmlnCiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3RzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gZW1haWw6ICJzaGllbGRAcmVkaGF0LmNvbSIKICAgICAgICAgICAgICAgICAga2V5Q29uZmlnOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogc2FtcGxlLXNpZ25lci1rZXljb25maWcKICAgICAgICAgICAgICAgICAgICAgIHNlY3JldE5hbWU6IGtleXJpbmctc2VjcmV0CiAgICAgICAgICAgICAgICAgIHJlc291cmNlU2lnbmluZ1Byb2ZpbGVzOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogcG9saWN5LXJzcAogICAgICAgICAgICAgICAgICAgICAgcHJvdGVjdFJ1bGVzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQ6KiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQtYWRkb246KiIKICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQ2hlY2tSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBQb2xpY3kKICAgICAgICAgICAgICAgICAgICAgIGt1c3RvbWl6ZVBhdHRlcm5zOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IFBvbGljeQogICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQcmVmaXg6ICIqLiIKICAgICAgICAgICAgICAgICAgICAgIHVucHJvdGVjdEF0dHJzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1kZXBsb3lhYmxlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1zdWJzY3JpcHRpb25cIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmFubm90YXRpb25zLlwiYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9zeW5jLXNvdXJjZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZXNwYWNlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5sYWJlbHMuXCJwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vcm9vdC1wb2xpY3lcIiIKICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGtleTogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2lzQ2x1c3Rlck5hbWVzcGFjZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogSW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbInRydWUiXQotLS0KYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBsYWNlbWVudEJpbmRpbmcKbWV0YWRhdGE6CiAgbmFtZTogYmluZGluZy1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpwbGFjZW1lbnRSZWY6CiAgbmFtZTogcGxhY2VtZW50LXBvbGljeS1pbnRlZ3JpdHktc2hpZWxkCiAga2luZDogUGxhY2VtZW50UnVsZQogIGFwaUdyb3VwOiBhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCnN1YmplY3RzOgogIC0gbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQKICAgIGtpbmQ6IFBvbGljeQogICAgYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwotLS0KYXBpVmVyc2lvbjogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRSdWxlCm1ldGFkYXRhOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpzcGVjOgogIGNsdXN0ZXJDb25kaXRpb25zOgogICAgLSBzdGF0dXM6ICJUcnVlIgogICAgICB0eXBlOiBNYW5hZ2VkQ2x1c3RlckNvbmRpdGlvbkF2YWlsYWJsZQogIGNsdXN0ZXJTZWxlY3RvcjoKICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgIC0ge2tleTogZW52aXJvbm1lbnQsIG9wZXJhdG9yOiBJbiwgdmFsdWVzOiBbImRldiJdfQo=
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhHTVNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaXpLWUwvaUUzOW9oRktCdXlFL09XRWVnMmtpUTV6b2RxYndLbgptdWZwcWNZNUFoVzdKNlRVTVp2bzVrdGpzaThWWVdVRUg1dzBXbTNxWUJWZXAxcUlqUzhyalAvMFV3OU1qeEYwCnR1eXVUQmcrOXM3RDZqY2dOcHNWa1U2c2RyL3ZvbmR1ZlJnczNHNkIwcGhtK3VsSERmMVlkbmlQMkRsU2tFbGcKUitHZThZK3gyTXp1WHZIak9MSzV1YngvQUhEQlc2M0RmWVVsUG1wNXVSakYzY1QvZlY5OTVXbjMxb1l5WkNxZQpJRExJaFA5WkMyY3V6c1NTM25JN1VHN0dueWk0M1o4YjdRc0R4ZHFxb0ZEYTM2eGlqVE1IMm5IWXpBdUprNXNSCjRjKzM5eW93bGFMU3NCS0FxWGpkd0NyM3BsM01mclJ6MUEvUlo3THJ3VndkRjJnek5CdlVYK09mbm9OcGxmN2YKczI5NnF0elV0bVduaFJtMG9yS3Q4ZFh2RVhrck55ZkJJRklxbTdwNHc4K2NYVlgrRGRFcWYxZlFvY29RMU9iego4dUVHSGVSTlRYVUhIdmpHbFpOWEhobzlNR2xlVVNzOTk2ekQzRjJPNGlBbU1sSjJRdlZpeVRPS1RLUmJaWlhxCnpEVGk2aitLcGg5Y2VldnVsQkg5NDY1MUhiVS9FcS80WUE9PQo9WDFSaQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-namespace
        spec:
          remediationAction: enforce
          severity: High
          object-templates:
            - complianceType: musthave
              objectDefinition:
                kind: Namespace
                apiVersion: v1
                metadata:
                  name: integrity-shield-operator-system
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-og
        spec:
          remediationAction: enforce
          severity: high
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: operators.coreos.com/v1
                kind: OperatorGroup
                metadata:
                  name: integrity-operator-group
                  namespace: integrity-shield-operator-system
                spec:
                  targetNamespaces:
                    - integrity-shield-operator-system
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-sub
        spec:
          remediationAction: enforce
          severity: high
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: operators.coreos.com/v1alpha1
                kind: Subscription
                metadata:
                  name: integrity-shield-operator
                  namespace: integrity-shield-operator-system
                spec:
                  channel: alpha
                  installPlanApproval: Automatic
                  name: integrity-shield-operator
                  source: community-operators
                  sourceNamespace: openshift-marketplace
                  startingCSV: integrity-shield-operator.v0.1.3
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-cr
        spec:
          remediationAction: enforce
          severity: high
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: apis.integrityshield.io/v1alpha1
                kind: IntegrityShield
                metadata:
                  name: integrity-shield-server
                  namespace: integrity-shield-operator-system
                spec:
                  logger:
                    image: quay.io/open-cluster-management/integrity-shield-logging:0.1.3
                  server:
                    image: quay.io/open-cluster-management/integrity-shield-server:0.1.3
                  affinity: {}
                  shieldConfig:
                    verifyType: pgp # x509
                    iShieldAdminUserName: "system:serviceaccount:open-cluster-management-agent-addon:klusterlet-addon-policyctrl"
                    inScopeNamespaceSelector:
                      include:
                        - "*"
                      exclude:
                        - "kube-*"
                        - "openshift-*"
                  signerConfig:
                    policies:
                      - namespaces:
                          - "*"
                        signers:
                          - "SampleSigner"
                      - scope: "Cluster"
                        signers:
                          - "SampleSigner"
                    signers:
                      - name: "SampleSigner"
                        keyConfig: sample-signer-keyconfig
                        subjects:
                          - email: "shield@redhat.com"
                  keyConfig:
                    - name: sample-signer-keyconfig
                      secretName: keyring-secret
                  resourceSigningProfiles:
                    - name: policy-rsp
                      protectRules:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                      ignoreRules:
                        - match:
                            - username: "system:serviceaccount:open-cluster-management-agent:*"
                            - username: "system:serviceaccount:open-cluster-management-agent-addon:*"
                      forceCheckRules:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                              kind: Policy
                      kustomizePatterns:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                              kind: Policy
                          namePrefix: "*."
                      unprotectAttrs:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                          attrs:
                            - "metadata.annotations.\"apps.open-cluster-management.io/hosting-deployable\""
                            - "metadata.annotations.\"apps.open-cluster-management.io/hosting-subscription\""
                            - "metadata.annotations.\"apps.open-cluster-management.io/sync-source\""
                            - "metadata.labels.\"policy.open-cluster-management.io/cluster-name\""
                            - "metadata.labels.\"policy.open-cluster-management.io/cluster-namespace\""
                            - "metadata.labels.\"policy.open-cluster-management.io/root-policy\""
                      targetNamespaceSelector:
                        labelSelector:
                          matchExpressions:
                            - key: policy.open-cluster-management.io/isClusterNamespace
                              operator: In
                              values: ["true"]
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-integrity-shield
  annotations: {integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOgogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3N0YW5kYXJkczogTklTVCBTUCA4MDAtNTMKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jYXRlZ29yaWVzOiBDTSBDb25maWd1cmF0aW9uIE1hbmFnZW1lbnQKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogQ00tNSBBY2Nlc3MgUmVzdHJpY3Rpb25zIGZvciBDaGFuZ2UKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogaW5mb3JtCiAgZGlzYWJsZWQ6IGZhbHNlCiAgcG9saWN5LXRlbXBsYXRlczoKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1uYW1lc3BhY2UKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBIaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBraW5kOiBOYW1lc3BhY2UKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IHYxCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1vZwogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IG9wZXJhdG9ycy5jb3Jlb3MuY29tL3YxCiAgICAgICAgICAgICAgICBraW5kOiBPcGVyYXRvckdyb3VwCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LW9wZXJhdG9yLWdyb3VwCiAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgICAgICAgICAgICAgIHNwZWM6CiAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWVzcGFjZXM6CiAgICAgICAgICAgICAgICAgICAgLSBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yLXN5c3RlbQogICAgLSBvYmplY3REZWZpbml0aW9uOgogICAgICAgIGFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQogICAgICAgIGtpbmQ6IENvbmZpZ3VyYXRpb25Qb2xpY3kKICAgICAgICBtZXRhZGF0YToKICAgICAgICAgIG5hbWU6IHBvbGljeS1pbnRlZ3JpdHktc2hpZWxkLXN1YgogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IG9wZXJhdG9ycy5jb3Jlb3MuY29tL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBTdWJzY3JpcHRpb24KICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yCiAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgICAgICAgICAgICAgIHNwZWM6CiAgICAgICAgICAgICAgICAgIGNoYW5uZWw6IGFscGhhCiAgICAgICAgICAgICAgICAgIGluc3RhbGxQbGFuQXBwcm92YWw6IEF1dG9tYXRpYwogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yCiAgICAgICAgICAgICAgICAgIHNvdXJjZTogY29tbXVuaXR5LW9wZXJhdG9ycwogICAgICAgICAgICAgICAgICBzb3VyY2VOYW1lc3BhY2U6IG9wZW5zaGlmdC1tYXJrZXRwbGFjZQogICAgICAgICAgICAgICAgICBzdGFydGluZ0NTVjogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci52MC4xLjMKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1jcgogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGFwaXMuaW50ZWdyaXR5c2hpZWxkLmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBJbnRlZ3JpdHlTaGllbGQKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLXNlcnZlcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBsb2dnZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHF1YXkuaW8vb3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQvaW50ZWdyaXR5LXNoaWVsZC1sb2dnaW5nOjAuMS4zCiAgICAgICAgICAgICAgICAgIHNlcnZlcjoKICAgICAgICAgICAgICAgICAgICBpbWFnZTogcXVheS5pby9vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC9pbnRlZ3JpdHktc2hpZWxkLXNlcnZlcjowLjEuMwogICAgICAgICAgICAgICAgICBhZmZpbml0eToge30KICAgICAgICAgICAgICAgICAgc2hpZWxkQ29uZmlnOgogICAgICAgICAgICAgICAgICAgIHZlcmlmeVR5cGU6IHBncCAjIHg1MDkKICAgICAgICAgICAgICAgICAgICBpU2hpZWxkQWRtaW5Vc2VyTmFtZTogInN5c3RlbTpzZXJ2aWNlYWNjb3VudDpvcGVuLWNsdXN0ZXItbWFuYWdlbWVudC1hZ2VudC1hZGRvbjprbHVzdGVybGV0LWFkZG9uLXBvbGljeWN0cmwiCiAgICAgICAgICAgICAgICAgICAgaW5TY29wZU5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZToKICAgICAgICAgICAgICAgICAgICAgICAgLSAiKiIKICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gImt1YmUtKiIKICAgICAgICAgICAgICAgICAgICAgICAgLSAib3BlbnNoaWZ0LSoiCiAgICAgICAgICAgICAgICAgIHNpZ25lckNvbmZpZzoKICAgICAgICAgICAgICAgICAgICBwb2xpY2llczoKICAgICAgICAgICAgICAgICAgICAgIC0gbmFtZXNwYWNlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICIqIgogICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICAgIC0gc2NvcGU6ICJDbHVzdGVyIgogICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgLSBuYW1lOiAiU2FtcGxlU2lnbmVyIgogICAgICAgICAgICAgICAgICAgICAgICBrZXlDb25maWc6IHNhbXBsZS1zaWduZXIta2V5Y29uZmlnCiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3RzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gZW1haWw6ICJzaGllbGRAcmVkaGF0LmNvbSIKICAgICAgICAgICAgICAgICAga2V5Q29uZmlnOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogc2FtcGxlLXNpZ25lci1rZXljb25maWcKICAgICAgICAgICAgICAgICAgICAgIHNlY3JldE5hbWU6IGtleXJpbmctc2VjcmV0CiAgICAgICAgICAgICAgICAgIHJlc291cmNlU2lnbmluZ1Byb2ZpbGVzOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogcG9saWN5LXJzcAogICAgICAgICAgICAgICAgICAgICAgcHJvdGVjdFJ1bGVzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQ6KiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQtYWRkb246KiIKICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQ2hlY2tSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBQb2xpY3kKICAgICAgICAgICAgICAgICAgICAgIGt1c3RvbWl6ZVBhdHRlcm5zOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IFBvbGljeQogICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQcmVmaXg6ICIqLiIKICAgICAgICAgICAgICAgICAgICAgIHVucHJvdGVjdEF0dHJzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1kZXBsb3lhYmxlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1zdWJzY3JpcHRpb25cIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmFubm90YXRpb25zLlwiYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9zeW5jLXNvdXJjZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZXNwYWNlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5sYWJlbHMuXCJwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vcm9vdC1wb2xpY3lcIiIKICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGtleTogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2lzQ2x1c3Rlck5hbWVzcGFjZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogSW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbInRydWUiXQotLS0KYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBsYWNlbWVudEJpbmRpbmcKbWV0YWRhdGE6CiAgbmFtZTogYmluZGluZy1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpwbGFjZW1lbnRSZWY6CiAgbmFtZTogcGxhY2VtZW50LXBvbGljeS1pbnRlZ3JpdHktc2hpZWxkCiAga2luZDogUGxhY2VtZW50UnVsZQogIGFwaUdyb3VwOiBhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCnN1YmplY3RzOgogIC0gbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQKICAgIGtpbmQ6IFBvbGljeQogICAgYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwotLS0KYXBpVmVyc2lvbjogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRSdWxlCm1ldGFkYXRhOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpzcGVjOgogIGNsdXN0ZXJDb25kaXRpb25zOgogICAgLSBzdGF0dXM6ICJUcnVlIgogICAgICB0eXBlOiBNYW5hZ2VkQ2x1c3RlckNvbmRpdGlvbkF2YWlsYWJsZQogIGNsdXN0ZXJTZWxlY3RvcjoKICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgIC0ge2tleTogZW52aXJvbm1lbnQsIG9wZXJhdG9yOiBJbiwgdmFsdWVzOiBbImRldiJdfQo=, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhHTVNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaXpLWUwvaUUzOW9oRktCdXlFL09XRWVnMmtpUTV6b2RxYndLbgptdWZwcWNZNUFoVzdKNlRVTVp2bzVrdGpzaThWWVdVRUg1dzBXbTNxWUJWZXAxcUlqUzhyalAvMFV3OU1qeEYwCnR1eXVUQmcrOXM3RDZqY2dOcHNWa1U2c2RyL3ZvbmR1ZlJnczNHNkIwcGhtK3VsSERmMVlkbmlQMkRsU2tFbGcKUitHZThZK3gyTXp1WHZIak9MSzV1YngvQUhEQlc2M0RmWVVsUG1wNXVSakYzY1QvZlY5OTVXbjMxb1l5WkNxZQpJRExJaFA5WkMyY3V6c1NTM25JN1VHN0dueWk0M1o4YjdRc0R4ZHFxb0ZEYTM2eGlqVE1IMm5IWXpBdUprNXNSCjRjKzM5eW93bGFMU3NCS0FxWGpkd0NyM3BsM01mclJ6MUEvUlo3THJ3VndkRjJnek5CdlVYK09mbm9OcGxmN2YKczI5NnF0elV0bVduaFJtMG9yS3Q4ZFh2RVhrck55ZkJJRklxbTdwNHc4K2NYVlgrRGRFcWYxZlFvY29RMU9iego4dUVHSGVSTlRYVUhIdmpHbFpOWEhobzlNR2xlVVNzOTk2ekQzRjJPNGlBbU1sSjJRdlZpeVRPS1RLUmJaWlhxCnpEVGk2aitLcGg5Y2VldnVsQkg5NDY1MUhiVS9FcS80WUE9PQo9WDFSaQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
placementRef:
  name: placement-policy-integrity-shield
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-integrity-shield
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-integrity-shield
  annotations: {integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOgogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3N0YW5kYXJkczogTklTVCBTUCA4MDAtNTMKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jYXRlZ29yaWVzOiBDTSBDb25maWd1cmF0aW9uIE1hbmFnZW1lbnQKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogQ00tNSBBY2Nlc3MgUmVzdHJpY3Rpb25zIGZvciBDaGFuZ2UKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogaW5mb3JtCiAgZGlzYWJsZWQ6IGZhbHNlCiAgcG9saWN5LXRlbXBsYXRlczoKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1uYW1lc3BhY2UKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBIaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBraW5kOiBOYW1lc3BhY2UKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IHYxCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1vZwogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IG9wZXJhdG9ycy5jb3Jlb3MuY29tL3YxCiAgICAgICAgICAgICAgICBraW5kOiBPcGVyYXRvckdyb3VwCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LW9wZXJhdG9yLWdyb3VwCiAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgICAgICAgICAgICAgIHNwZWM6CiAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWVzcGFjZXM6CiAgICAgICAgICAgICAgICAgICAgLSBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yLXN5c3RlbQogICAgLSBvYmplY3REZWZpbml0aW9uOgogICAgICAgIGFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQogICAgICAgIGtpbmQ6IENvbmZpZ3VyYXRpb25Qb2xpY3kKICAgICAgICBtZXRhZGF0YToKICAgICAgICAgIG5hbWU6IHBvbGljeS1pbnRlZ3JpdHktc2hpZWxkLXN1YgogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IG9wZXJhdG9ycy5jb3Jlb3MuY29tL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBTdWJzY3JpcHRpb24KICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yCiAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgICAgICAgICAgICAgIHNwZWM6CiAgICAgICAgICAgICAgICAgIGNoYW5uZWw6IGFscGhhCiAgICAgICAgICAgICAgICAgIGluc3RhbGxQbGFuQXBwcm92YWw6IEF1dG9tYXRpYwogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yCiAgICAgICAgICAgICAgICAgIHNvdXJjZTogY29tbXVuaXR5LW9wZXJhdG9ycwogICAgICAgICAgICAgICAgICBzb3VyY2VOYW1lc3BhY2U6IG9wZW5zaGlmdC1tYXJrZXRwbGFjZQogICAgICAgICAgICAgICAgICBzdGFydGluZ0NTVjogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci52MC4xLjMKICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1jcgogICAgICAgIHNwZWM6CiAgICAgICAgICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG9iamVjdC10ZW1wbGF0ZXM6CiAgICAgICAgICAgIC0gY29tcGxpYW5jZVR5cGU6IG11c3RoYXZlCiAgICAgICAgICAgICAgb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICAgICAgICAgIGFwaVZlcnNpb246IGFwaXMuaW50ZWdyaXR5c2hpZWxkLmlvL3YxYWxwaGExCiAgICAgICAgICAgICAgICBraW5kOiBJbnRlZ3JpdHlTaGllbGQKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBuYW1lOiBpbnRlZ3JpdHktc2hpZWxkLXNlcnZlcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBsb2dnZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHF1YXkuaW8vb3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQvaW50ZWdyaXR5LXNoaWVsZC1sb2dnaW5nOjAuMS4zCiAgICAgICAgICAgICAgICAgIHNlcnZlcjoKICAgICAgICAgICAgICAgICAgICBpbWFnZTogcXVheS5pby9vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC9pbnRlZ3JpdHktc2hpZWxkLXNlcnZlcjowLjEuMwogICAgICAgICAgICAgICAgICBhZmZpbml0eToge30KICAgICAgICAgICAgICAgICAgc2hpZWxkQ29uZmlnOgogICAgICAgICAgICAgICAgICAgIHZlcmlmeVR5cGU6IHBncCAjIHg1MDkKICAgICAgICAgICAgICAgICAgICBpU2hpZWxkQWRtaW5Vc2VyTmFtZTogInN5c3RlbTpzZXJ2aWNlYWNjb3VudDpvcGVuLWNsdXN0ZXItbWFuYWdlbWVudC1hZ2VudC1hZGRvbjprbHVzdGVybGV0LWFkZG9uLXBvbGljeWN0cmwiCiAgICAgICAgICAgICAgICAgICAgaW5TY29wZU5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgaW5jbHVkZToKICAgICAgICAgICAgICAgICAgICAgICAgLSAiKiIKICAgICAgICAgICAgICAgICAgICAgIGV4Y2x1ZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gImt1YmUtKiIKICAgICAgICAgICAgICAgICAgICAgICAgLSAib3BlbnNoaWZ0LSoiCiAgICAgICAgICAgICAgICAgIHNpZ25lckNvbmZpZzoKICAgICAgICAgICAgICAgICAgICBwb2xpY2llczoKICAgICAgICAgICAgICAgICAgICAgIC0gbmFtZXNwYWNlczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICIqIgogICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICAgIC0gc2NvcGU6ICJDbHVzdGVyIgogICAgICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICBzaWduZXJzOgogICAgICAgICAgICAgICAgICAgICAgLSBuYW1lOiAiU2FtcGxlU2lnbmVyIgogICAgICAgICAgICAgICAgICAgICAgICBrZXlDb25maWc6IHNhbXBsZS1zaWduZXIta2V5Y29uZmlnCiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3RzOgogICAgICAgICAgICAgICAgICAgICAgICAgIC0gZW1haWw6ICJzaGllbGRAcmVkaGF0LmNvbSIKICAgICAgICAgICAgICAgICAga2V5Q29uZmlnOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogc2FtcGxlLXNpZ25lci1rZXljb25maWcKICAgICAgICAgICAgICAgICAgICAgIHNlY3JldE5hbWU6IGtleXJpbmctc2VjcmV0CiAgICAgICAgICAgICAgICAgIHJlc291cmNlU2lnbmluZ1Byb2ZpbGVzOgogICAgICAgICAgICAgICAgICAgIC0gbmFtZTogcG9saWN5LXJzcAogICAgICAgICAgICAgICAgICAgICAgcHJvdGVjdFJ1bGVzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICBpZ25vcmVSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQ6KiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gdXNlcm5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQtYWRkb246KiIKICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQ2hlY2tSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBQb2xpY3kKICAgICAgICAgICAgICAgICAgICAgIGt1c3RvbWl6ZVBhdHRlcm5zOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtpbmQ6IFBvbGljeQogICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVQcmVmaXg6ICIqLiIKICAgICAgICAgICAgICAgICAgICAgIHVucHJvdGVjdEF0dHJzOgogICAgICAgICAgICAgICAgICAgICAgICAtIG1hdGNoOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBhcGlHcm91cDogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCiAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1kZXBsb3lhYmxlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vaG9zdGluZy1zdWJzY3JpcHRpb25cIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmFubm90YXRpb25zLlwiYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9zeW5jLXNvdXJjZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2NsdXN0ZXItbmFtZXNwYWNlXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5sYWJlbHMuXCJwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vcm9vdC1wb2xpY3lcIiIKICAgICAgICAgICAgICAgICAgICAgIHRhcmdldE5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFNlbGVjdG9yOgogICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGtleTogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2lzQ2x1c3Rlck5hbWVzcGFjZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVyYXRvcjogSW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBbInRydWUiXQotLS0KYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBsYWNlbWVudEJpbmRpbmcKbWV0YWRhdGE6CiAgbmFtZTogYmluZGluZy1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpwbGFjZW1lbnRSZWY6CiAgbmFtZTogcGxhY2VtZW50LXBvbGljeS1pbnRlZ3JpdHktc2hpZWxkCiAga2luZDogUGxhY2VtZW50UnVsZQogIGFwaUdyb3VwOiBhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCnN1YmplY3RzOgogIC0gbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQKICAgIGtpbmQ6IFBvbGljeQogICAgYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwotLS0KYXBpVmVyc2lvbjogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRSdWxlCm1ldGFkYXRhOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOiB7fQpzcGVjOgogIGNsdXN0ZXJDb25kaXRpb25zOgogICAgLSBzdGF0dXM6ICJUcnVlIgogICAgICB0eXBlOiBNYW5hZ2VkQ2x1c3RlckNvbmRpdGlvbkF2YWlsYWJsZQogIGNsdXN0ZXJTZWxlY3RvcjoKICAgIG1hdGNoRXhwcmVzc2lvbnM6CiAgICAgIC0ge2tleTogZW52aXJvbm1lbnQsIG9wZXJhdG9yOiBJbiwgdmFsdWVzOiBbImRldiJdfQo=, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhHTVNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaXpLWUwvaUUzOW9oRktCdXlFL09XRWVnMmtpUTV6b2RxYndLbgptdWZwcWNZNUFoVzdKNlRVTVp2bzVrdGpzaThWWVdVRUg1dzBXbTNxWUJWZXAxcUlqUzhyalAvMFV3OU1qeEYwCnR1eXVUQmcrOXM3RDZqY2dOcHNWa1U2c2RyL3ZvbmR1ZlJnczNHNkIwcGhtK3VsSERmMVlkbmlQMkRsU2tFbGcKUitHZThZK3gyTXp1WHZIak9MSzV1YngvQUhEQlc2M0RmWVVsUG1wNXVSakYzY1QvZlY5OTVXbjMxb1l5WkNxZQpJRExJaFA5WkMyY3V6c1NTM25JN1VHN0dueWk0M1o4YjdRc0R4ZHFxb0ZEYTM2eGlqVE1IMm5IWXpBdUprNXNSCjRjKzM5eW93bGFMU3NCS0FxWGpkd0NyM3BsM01mclJ6MUEvUlo3THJ3VndkRjJnek5CdlVYK09mbm9OcGxmN2YKczI5NnF0elV0bVduaFJtMG9yS3Q4ZFh2RVhrck55ZkJJRklxbTdwNHc4K2NYVlgrRGRFcWYxZlFvY29RMU9iego4dUVHSGVSTlRYVUhIdmpHbFpOWEhobzlNR2xlVVNzOTk2ekQzRjJPNGlBbU1sSjJRdlZpeVRPS1RLUmJaWlhxCnpEVGk2aitLcGg5Y2VldnVsQkg5NDY1MUhiVS9FcS80WUE9PQo9WDFSaQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
