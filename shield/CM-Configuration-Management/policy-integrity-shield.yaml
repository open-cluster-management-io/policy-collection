apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-integrity-shield
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: CM Configuration Management
    policy.open-cluster-management.io/controls: CM-5 Access Restrictions for Change
    integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOgogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3N0YW5kYXJkczogTklTVCBTUCA4MDAtNTMKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jYXRlZ29yaWVzOiBDTSBDb25maWd1cmF0aW9uIE1hbmFnZW1lbnQKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogQ00tNSBBY2Nlc3MgUmVzdHJpY3Rpb25zIGZvciBDaGFuZ2UKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogIGRpc2FibGVkOiBmYWxzZQogIHBvbGljeS10ZW1wbGF0ZXM6CiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtbmFtZXNwYWNlCiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBlbmZvcmNlCiAgICAgICAgICBzZXZlcml0eTogSGlnaAogICAgICAgICAgb2JqZWN0LXRlbXBsYXRlczoKICAgICAgICAgICAgLSBjb21wbGlhbmNlVHlwZTogbXVzdGhhdmUKICAgICAgICAgICAgICBvYmplY3REZWZpbml0aW9uOgogICAgICAgICAgICAgICAga2luZDogTmFtZXNwYWNlCiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiB2MQogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtb2cKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MQogICAgICAgICAgICAgICAga2luZDogT3BlcmF0b3JHcm91cAogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1vcGVyYXRvci1ncm91cAogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICB0YXJnZXROYW1lc3BhY2VzOgogICAgICAgICAgICAgICAgICAgIC0gaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1zdWIKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogU3Vic2NyaXB0aW9uCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBjaGFubmVsOiBhbHBoYQogICAgICAgICAgICAgICAgICBpbnN0YWxsUGxhbkFwcHJvdmFsOiBBdXRvbWF0aWMKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBzb3VyY2U6IGNvbW11bml0eS1vcGVyYXRvcnMKICAgICAgICAgICAgICAgICAgc291cmNlTmFtZXNwYWNlOiBvcGVuc2hpZnQtbWFya2V0cGxhY2UKICAgICAgICAgICAgICAgICAgc3RhcnRpbmdDU1Y6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3IudjAuMS4zCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtY3IKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBhcGlzLmludGVncml0eXNoaWVsZC5pby92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogSW50ZWdyaXR5U2hpZWxkCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1zZXJ2ZXIKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yLXN5c3RlbQogICAgICAgICAgICAgICAgc3BlYzoKICAgICAgICAgICAgICAgICAgbG9nZ2VyOgogICAgICAgICAgICAgICAgICAgIGltYWdlOiBxdWF5LmlvL29wZW4tY2x1c3Rlci1tYW5hZ2VtZW50L2ludGVncml0eS1zaGllbGQtbG9nZ2luZzowLjEuMwogICAgICAgICAgICAgICAgICBzZXJ2ZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHF1YXkuaW8vb3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQvaW50ZWdyaXR5LXNoaWVsZC1zZXJ2ZXI6MC4xLjMKICAgICAgICAgICAgICAgICAgYWZmaW5pdHk6IHt9CiAgICAgICAgICAgICAgICAgIHNoaWVsZENvbmZpZzoKICAgICAgICAgICAgICAgICAgICB2ZXJpZnlUeXBlOiBwZ3AgIyB4NTA5CiAgICAgICAgICAgICAgICAgICAgaVNoaWVsZEFkbWluVXNlck5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQtYWRkb246a2x1c3RlcmxldC1hZGRvbi1wb2xpY3ljdHJsIgogICAgICAgICAgICAgICAgICAgIGluU2NvcGVOYW1lc3BhY2VTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gIioiCiAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlOgogICAgICAgICAgICAgICAgICAgICAgICAtICJrdWJlLSoiCiAgICAgICAgICAgICAgICAgICAgICAgIC0gIm9wZW5zaGlmdC0qIgogICAgICAgICAgICAgICAgICBzaWduZXJDb25maWc6CiAgICAgICAgICAgICAgICAgICAgcG9saWNpZXM6CiAgICAgICAgICAgICAgICAgICAgICAtIG5hbWVzcGFjZXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgLSAiKiIKICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICJTYW1wbGVTaWduZXIiCiAgICAgICAgICAgICAgICAgICAgICAtIHNjb3BlOiAiQ2x1c3RlciIKICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICJTYW1wbGVTaWduZXIiCiAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgIC0gbmFtZTogIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICAgICAga2V5Q29uZmlnOiBzYW1wbGUtc2lnbmVyLWtleWNvbmZpZwogICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0czoKICAgICAgICAgICAgICAgICAgICAgICAgICAtIGVtYWlsOiAic2hpZWxkQHJlZGhhdC5jb20iCiAgICAgICAgICAgICAgICAgIGtleUNvbmZpZzoKICAgICAgICAgICAgICAgICAgICAtIG5hbWU6IHNhbXBsZS1zaWduZXIta2V5Y29uZmlnCiAgICAgICAgICAgICAgICAgICAgICBzZWNyZXROYW1lOiBrZXlyaW5nLXNlY3JldAogICAgICAgICAgICAgICAgICByZXNvdXJjZVNpZ25pbmdQcm9maWxlczoKICAgICAgICAgICAgICAgICAgICAtIG5hbWU6IHBvbGljeS1yc3AKICAgICAgICAgICAgICAgICAgICAgIHByb3RlY3RSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgaWdub3JlUnVsZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gbWF0Y2g6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHVzZXJuYW1lOiAic3lzdGVtOnNlcnZpY2VhY2NvdW50Om9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LWFnZW50OioiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHVzZXJuYW1lOiAic3lzdGVtOnNlcnZpY2VhY2NvdW50Om9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LWFnZW50LWFkZG9uOioiCiAgICAgICAgICAgICAgICAgICAgICBmb3JjZUNoZWNrUnVsZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gbWF0Y2g6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogUG9saWN5CiAgICAgICAgICAgICAgICAgICAgICBrdXN0b21pemVQYXR0ZXJuczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBQb2xpY3kKICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lUHJlZml4OiAiKi4iCiAgICAgICAgICAgICAgICAgICAgICB1bnByb3RlY3RBdHRyczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEuYW5ub3RhdGlvbnMuXCJhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2hvc3RpbmctZGVwbG95YWJsZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEuYW5ub3RhdGlvbnMuXCJhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2hvc3Rpbmctc3Vic2NyaXB0aW9uXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vc3luYy1zb3VyY2VcIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmxhYmVscy5cInBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jbHVzdGVyLW5hbWVcIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmxhYmVscy5cInBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jbHVzdGVyLW5hbWVzcGFjZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3Jvb3QtcG9saWN5XCIiCiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lc3BhY2VTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBrZXk6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9pc0NsdXN0ZXJOYW1lc3BhY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IEluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogWyJ0cnVlIl0KLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LWludGVncml0eS1zaGllbGQKICBhbm5vdGF0aW9uczoge30KcGxhY2VtZW50UmVmOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGtpbmQ6IFBsYWNlbWVudFJ1bGUKICBhcGlHcm91cDogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwpzdWJqZWN0czoKICAtIG5hbWU6IHBvbGljeS1pbnRlZ3JpdHktc2hpZWxkCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LWludGVncml0eS1zaGllbGQKICBhbm5vdGF0aW9uczoge30Kc3BlYzoKICBjbHVzdGVyQ29uZGl0aW9uczoKICAgIC0gc3RhdHVzOiAiVHJ1ZSIKICAgICAgdHlwZTogTWFuYWdlZENsdXN0ZXJDb25kaXRpb25BdmFpbGFibGUKICBjbHVzdGVyU2VsZWN0b3I6CiAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAtIHtrZXk6IGVudmlyb25tZW50LCBvcGVyYXRvcjogSW4sIHZhbHVlczogWyJkZXYiXX0K
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVpMTVNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaVdDOE1BSkJ4Wk5SL05TM2hsRjVQSkd5M2YxQ3BRNmozcDVSNwpzTkp1eERqV3VWTnJCS1JHdUJmU1o0c3VJVmIzQjltb3I4eDFoR20ycFN5M0ovUks1VmpSWi8wbWRSbW9qYWNICjVyT0YvR3pTSDNLMGFMdHhBREFFMFIrVEtBQjREWThTUThJUkF3TGxpTm51aDNYUEV2WVB2a1p6U3BhWjE4ZkIKVklwYy9XZ2d3MDJqa1BMaW5BYmwrbmZiTTVjdERybjFCY2RPdGd2TzlmclRZTG4wOWdlWFlxY1pVb1lmbHdrNgp5MXNUOTVTRk5PVkhnK0dITTUvL2VTMjhSYVhRSmNMb045WXdSbzFYcWZHNEludWpkL2hGR0JLT2FNdHlDVjZsCmJsSVMwd1pOVEtNWm9rdzVLanI4OUU2cnJocFlrK1h2Yk82bUpBUURMVmxpcVJxaGlCaFFkelVHbEJFNDVEMDUKUTR4OG1Wcms4OVBJUUh2S25GVi9RS3hBcjc5WG0xY0FsM1NjdEFqWUlBTGdRMGFBbHNHeXNsdUZNNnZheklyTwpmMm10ejY3UU1tV0JVVmNoT05XbHlmMkpJT0l3b2R0WHk5eUxITlpuempnNFNhRlRtVXJ1ZEZqMDNDdnl5dzJmCnA2NWpUUjkrZXNFUm92QnVEdWI3WG55d3BvakRocGNSTlE9PQo9V1krMQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K
spec:
  remediationAction: enforce
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-namespace
        spec:
          remediationAction: enforce
          severity: High
          object-templates:
            - complianceType: musthave
              objectDefinition:
                kind: Namespace
                apiVersion: v1
                metadata:
                  name: integrity-shield-operator-system
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-og
        spec:
          remediationAction: enforce
          severity: high
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: operators.coreos.com/v1
                kind: OperatorGroup
                metadata:
                  name: integrity-operator-group
                  namespace: integrity-shield-operator-system
                spec:
                  targetNamespaces:
                    - integrity-shield-operator-system
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-sub
        spec:
          remediationAction: enforce
          severity: high
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: operators.coreos.com/v1alpha1
                kind: Subscription
                metadata:
                  name: integrity-shield-operator
                  namespace: integrity-shield-operator-system
                spec:
                  channel: alpha
                  installPlanApproval: Automatic
                  name: integrity-shield-operator
                  source: community-operators
                  sourceNamespace: openshift-marketplace
                  startingCSV: integrity-shield-operator.v0.1.3
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-integrity-shield-cr
        spec:
          remediationAction: enforce
          severity: high
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: apis.integrityshield.io/v1alpha1
                kind: IntegrityShield
                metadata:
                  name: integrity-shield-server
                  namespace: integrity-shield-operator-system
                spec:
                  logger:
                    image: quay.io/open-cluster-management/integrity-shield-logging:0.1.3
                  server:
                    image: quay.io/open-cluster-management/integrity-shield-server:0.1.3
                  affinity: {}
                  shieldConfig:
                    verifyType: pgp # x509
                    iShieldAdminUserName: "system:serviceaccount:open-cluster-management-agent-addon:klusterlet-addon-policyctrl"
                    inScopeNamespaceSelector:
                      include:
                        - "*"
                      exclude:
                        - "kube-*"
                        - "openshift-*"
                  signerConfig:
                    policies:
                      - namespaces:
                          - "*"
                        signers:
                          - "SampleSigner"
                      - scope: "Cluster"
                        signers:
                          - "SampleSigner"
                    signers:
                      - name: "SampleSigner"
                        keyConfig: sample-signer-keyconfig
                        subjects:
                          - email: "shield@redhat.com"
                  keyConfig:
                    - name: sample-signer-keyconfig
                      secretName: keyring-secret
                  resourceSigningProfiles:
                    - name: policy-rsp
                      protectRules:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                      ignoreRules:
                        - match:
                            - username: "system:serviceaccount:open-cluster-management-agent:*"
                            - username: "system:serviceaccount:open-cluster-management-agent-addon:*"
                      forceCheckRules:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                              kind: Policy
                      kustomizePatterns:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                              kind: Policy
                          namePrefix: "*."
                      unprotectAttrs:
                        - match:
                            - apiGroup: policy.open-cluster-management.io
                          attrs:
                            - "metadata.annotations.\"apps.open-cluster-management.io/hosting-deployable\""
                            - "metadata.annotations.\"apps.open-cluster-management.io/hosting-subscription\""
                            - "metadata.annotations.\"apps.open-cluster-management.io/sync-source\""
                            - "metadata.labels.\"policy.open-cluster-management.io/cluster-name\""
                            - "metadata.labels.\"policy.open-cluster-management.io/cluster-namespace\""
                            - "metadata.labels.\"policy.open-cluster-management.io/root-policy\""
                      targetNamespaceSelector:
                        labelSelector:
                          matchExpressions:
                            - key: policy.open-cluster-management.io/isClusterNamespace
                              operator: In
                              values: ["true"]
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-integrity-shield
  annotations: {integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOgogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3N0YW5kYXJkczogTklTVCBTUCA4MDAtNTMKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jYXRlZ29yaWVzOiBDTSBDb25maWd1cmF0aW9uIE1hbmFnZW1lbnQKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogQ00tNSBBY2Nlc3MgUmVzdHJpY3Rpb25zIGZvciBDaGFuZ2UKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogIGRpc2FibGVkOiBmYWxzZQogIHBvbGljeS10ZW1wbGF0ZXM6CiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtbmFtZXNwYWNlCiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBlbmZvcmNlCiAgICAgICAgICBzZXZlcml0eTogSGlnaAogICAgICAgICAgb2JqZWN0LXRlbXBsYXRlczoKICAgICAgICAgICAgLSBjb21wbGlhbmNlVHlwZTogbXVzdGhhdmUKICAgICAgICAgICAgICBvYmplY3REZWZpbml0aW9uOgogICAgICAgICAgICAgICAga2luZDogTmFtZXNwYWNlCiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiB2MQogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtb2cKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MQogICAgICAgICAgICAgICAga2luZDogT3BlcmF0b3JHcm91cAogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1vcGVyYXRvci1ncm91cAogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICB0YXJnZXROYW1lc3BhY2VzOgogICAgICAgICAgICAgICAgICAgIC0gaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1zdWIKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogU3Vic2NyaXB0aW9uCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBjaGFubmVsOiBhbHBoYQogICAgICAgICAgICAgICAgICBpbnN0YWxsUGxhbkFwcHJvdmFsOiBBdXRvbWF0aWMKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBzb3VyY2U6IGNvbW11bml0eS1vcGVyYXRvcnMKICAgICAgICAgICAgICAgICAgc291cmNlTmFtZXNwYWNlOiBvcGVuc2hpZnQtbWFya2V0cGxhY2UKICAgICAgICAgICAgICAgICAgc3RhcnRpbmdDU1Y6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3IudjAuMS4zCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtY3IKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBhcGlzLmludGVncml0eXNoaWVsZC5pby92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogSW50ZWdyaXR5U2hpZWxkCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1zZXJ2ZXIKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yLXN5c3RlbQogICAgICAgICAgICAgICAgc3BlYzoKICAgICAgICAgICAgICAgICAgbG9nZ2VyOgogICAgICAgICAgICAgICAgICAgIGltYWdlOiBxdWF5LmlvL29wZW4tY2x1c3Rlci1tYW5hZ2VtZW50L2ludGVncml0eS1zaGllbGQtbG9nZ2luZzowLjEuMwogICAgICAgICAgICAgICAgICBzZXJ2ZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHF1YXkuaW8vb3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQvaW50ZWdyaXR5LXNoaWVsZC1zZXJ2ZXI6MC4xLjMKICAgICAgICAgICAgICAgICAgYWZmaW5pdHk6IHt9CiAgICAgICAgICAgICAgICAgIHNoaWVsZENvbmZpZzoKICAgICAgICAgICAgICAgICAgICB2ZXJpZnlUeXBlOiBwZ3AgIyB4NTA5CiAgICAgICAgICAgICAgICAgICAgaVNoaWVsZEFkbWluVXNlck5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQtYWRkb246a2x1c3RlcmxldC1hZGRvbi1wb2xpY3ljdHJsIgogICAgICAgICAgICAgICAgICAgIGluU2NvcGVOYW1lc3BhY2VTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gIioiCiAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlOgogICAgICAgICAgICAgICAgICAgICAgICAtICJrdWJlLSoiCiAgICAgICAgICAgICAgICAgICAgICAgIC0gIm9wZW5zaGlmdC0qIgogICAgICAgICAgICAgICAgICBzaWduZXJDb25maWc6CiAgICAgICAgICAgICAgICAgICAgcG9saWNpZXM6CiAgICAgICAgICAgICAgICAgICAgICAtIG5hbWVzcGFjZXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgLSAiKiIKICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICJTYW1wbGVTaWduZXIiCiAgICAgICAgICAgICAgICAgICAgICAtIHNjb3BlOiAiQ2x1c3RlciIKICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICJTYW1wbGVTaWduZXIiCiAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgIC0gbmFtZTogIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICAgICAga2V5Q29uZmlnOiBzYW1wbGUtc2lnbmVyLWtleWNvbmZpZwogICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0czoKICAgICAgICAgICAgICAgICAgICAgICAgICAtIGVtYWlsOiAic2hpZWxkQHJlZGhhdC5jb20iCiAgICAgICAgICAgICAgICAgIGtleUNvbmZpZzoKICAgICAgICAgICAgICAgICAgICAtIG5hbWU6IHNhbXBsZS1zaWduZXIta2V5Y29uZmlnCiAgICAgICAgICAgICAgICAgICAgICBzZWNyZXROYW1lOiBrZXlyaW5nLXNlY3JldAogICAgICAgICAgICAgICAgICByZXNvdXJjZVNpZ25pbmdQcm9maWxlczoKICAgICAgICAgICAgICAgICAgICAtIG5hbWU6IHBvbGljeS1yc3AKICAgICAgICAgICAgICAgICAgICAgIHByb3RlY3RSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgaWdub3JlUnVsZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gbWF0Y2g6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHVzZXJuYW1lOiAic3lzdGVtOnNlcnZpY2VhY2NvdW50Om9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LWFnZW50OioiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHVzZXJuYW1lOiAic3lzdGVtOnNlcnZpY2VhY2NvdW50Om9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LWFnZW50LWFkZG9uOioiCiAgICAgICAgICAgICAgICAgICAgICBmb3JjZUNoZWNrUnVsZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gbWF0Y2g6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogUG9saWN5CiAgICAgICAgICAgICAgICAgICAgICBrdXN0b21pemVQYXR0ZXJuczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBQb2xpY3kKICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lUHJlZml4OiAiKi4iCiAgICAgICAgICAgICAgICAgICAgICB1bnByb3RlY3RBdHRyczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEuYW5ub3RhdGlvbnMuXCJhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2hvc3RpbmctZGVwbG95YWJsZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEuYW5ub3RhdGlvbnMuXCJhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2hvc3Rpbmctc3Vic2NyaXB0aW9uXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vc3luYy1zb3VyY2VcIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmxhYmVscy5cInBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jbHVzdGVyLW5hbWVcIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmxhYmVscy5cInBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jbHVzdGVyLW5hbWVzcGFjZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3Jvb3QtcG9saWN5XCIiCiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lc3BhY2VTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBrZXk6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9pc0NsdXN0ZXJOYW1lc3BhY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IEluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogWyJ0cnVlIl0KLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LWludGVncml0eS1zaGllbGQKICBhbm5vdGF0aW9uczoge30KcGxhY2VtZW50UmVmOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGtpbmQ6IFBsYWNlbWVudFJ1bGUKICBhcGlHcm91cDogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwpzdWJqZWN0czoKICAtIG5hbWU6IHBvbGljeS1pbnRlZ3JpdHktc2hpZWxkCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LWludGVncml0eS1zaGllbGQKICBhbm5vdGF0aW9uczoge30Kc3BlYzoKICBjbHVzdGVyQ29uZGl0aW9uczoKICAgIC0gc3RhdHVzOiAiVHJ1ZSIKICAgICAgdHlwZTogTWFuYWdlZENsdXN0ZXJDb25kaXRpb25BdmFpbGFibGUKICBjbHVzdGVyU2VsZWN0b3I6CiAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAtIHtrZXk6IGVudmlyb25tZW50LCBvcGVyYXRvcjogSW4sIHZhbHVlczogWyJkZXYiXX0K, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVpMTVNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaVdDOE1BSkJ4Wk5SL05TM2hsRjVQSkd5M2YxQ3BRNmozcDVSNwpzTkp1eERqV3VWTnJCS1JHdUJmU1o0c3VJVmIzQjltb3I4eDFoR20ycFN5M0ovUks1VmpSWi8wbWRSbW9qYWNICjVyT0YvR3pTSDNLMGFMdHhBREFFMFIrVEtBQjREWThTUThJUkF3TGxpTm51aDNYUEV2WVB2a1p6U3BhWjE4ZkIKVklwYy9XZ2d3MDJqa1BMaW5BYmwrbmZiTTVjdERybjFCY2RPdGd2TzlmclRZTG4wOWdlWFlxY1pVb1lmbHdrNgp5MXNUOTVTRk5PVkhnK0dITTUvL2VTMjhSYVhRSmNMb045WXdSbzFYcWZHNEludWpkL2hGR0JLT2FNdHlDVjZsCmJsSVMwd1pOVEtNWm9rdzVLanI4OUU2cnJocFlrK1h2Yk82bUpBUURMVmxpcVJxaGlCaFFkelVHbEJFNDVEMDUKUTR4OG1Wcms4OVBJUUh2S25GVi9RS3hBcjc5WG0xY0FsM1NjdEFqWUlBTGdRMGFBbHNHeXNsdUZNNnZheklyTwpmMm10ejY3UU1tV0JVVmNoT05XbHlmMkpJT0l3b2R0WHk5eUxITlpuempnNFNhRlRtVXJ1ZEZqMDNDdnl5dzJmCnA2NWpUUjkrZXNFUm92QnVEdWI3WG55d3BvakRocGNSTlE9PQo9V1krMQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
placementRef:
  name: placement-policy-integrity-shield
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-integrity-shield
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-integrity-shield
  annotations: {integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGFubm90YXRpb25zOgogICAgcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3N0YW5kYXJkczogTklTVCBTUCA4MDAtNTMKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jYXRlZ29yaWVzOiBDTSBDb25maWd1cmF0aW9uIE1hbmFnZW1lbnQKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogQ00tNSBBY2Nlc3MgUmVzdHJpY3Rpb25zIGZvciBDaGFuZ2UKc3BlYzoKICByZW1lZGlhdGlvbkFjdGlvbjogZW5mb3JjZQogIGRpc2FibGVkOiBmYWxzZQogIHBvbGljeS10ZW1wbGF0ZXM6CiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtbmFtZXNwYWNlCiAgICAgICAgc3BlYzoKICAgICAgICAgIHJlbWVkaWF0aW9uQWN0aW9uOiBlbmZvcmNlCiAgICAgICAgICBzZXZlcml0eTogSGlnaAogICAgICAgICAgb2JqZWN0LXRlbXBsYXRlczoKICAgICAgICAgICAgLSBjb21wbGlhbmNlVHlwZTogbXVzdGhhdmUKICAgICAgICAgICAgICBvYmplY3REZWZpbml0aW9uOgogICAgICAgICAgICAgICAga2luZDogTmFtZXNwYWNlCiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiB2MQogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtb2cKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MQogICAgICAgICAgICAgICAga2luZDogT3BlcmF0b3JHcm91cAogICAgICAgICAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICAgICAgICAgIG5hbWU6IGludGVncml0eS1vcGVyYXRvci1ncm91cAogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICB0YXJnZXROYW1lc3BhY2VzOgogICAgICAgICAgICAgICAgICAgIC0gaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvci1zeXN0ZW0KICAgIC0gb2JqZWN0RGVmaW5pdGlvbjoKICAgICAgICBhcGlWZXJzaW9uOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKICAgICAgICBraW5kOiBDb25maWd1cmF0aW9uUG9saWN5CiAgICAgICAgbWV0YWRhdGE6CiAgICAgICAgICBuYW1lOiBwb2xpY3ktaW50ZWdyaXR5LXNoaWVsZC1zdWIKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBvcGVyYXRvcnMuY29yZW9zLmNvbS92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogU3Vic2NyaXB0aW9uCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3Itc3lzdGVtCiAgICAgICAgICAgICAgICBzcGVjOgogICAgICAgICAgICAgICAgICBjaGFubmVsOiBhbHBoYQogICAgICAgICAgICAgICAgICBpbnN0YWxsUGxhbkFwcHJvdmFsOiBBdXRvbWF0aWMKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1vcGVyYXRvcgogICAgICAgICAgICAgICAgICBzb3VyY2U6IGNvbW11bml0eS1vcGVyYXRvcnMKICAgICAgICAgICAgICAgICAgc291cmNlTmFtZXNwYWNlOiBvcGVuc2hpZnQtbWFya2V0cGxhY2UKICAgICAgICAgICAgICAgICAgc3RhcnRpbmdDU1Y6IGludGVncml0eS1zaGllbGQtb3BlcmF0b3IudjAuMS4zCiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LWludGVncml0eS1zaGllbGQtY3IKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGVuZm9yY2UKICAgICAgICAgIHNldmVyaXR5OiBoaWdoCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBhcGlzLmludGVncml0eXNoaWVsZC5pby92MWFscGhhMQogICAgICAgICAgICAgICAga2luZDogSW50ZWdyaXR5U2hpZWxkCiAgICAgICAgICAgICAgICBtZXRhZGF0YToKICAgICAgICAgICAgICAgICAgbmFtZTogaW50ZWdyaXR5LXNoaWVsZC1zZXJ2ZXIKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiBpbnRlZ3JpdHktc2hpZWxkLW9wZXJhdG9yLXN5c3RlbQogICAgICAgICAgICAgICAgc3BlYzoKICAgICAgICAgICAgICAgICAgbG9nZ2VyOgogICAgICAgICAgICAgICAgICAgIGltYWdlOiBxdWF5LmlvL29wZW4tY2x1c3Rlci1tYW5hZ2VtZW50L2ludGVncml0eS1zaGllbGQtbG9nZ2luZzowLjEuMwogICAgICAgICAgICAgICAgICBzZXJ2ZXI6CiAgICAgICAgICAgICAgICAgICAgaW1hZ2U6IHF1YXkuaW8vb3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQvaW50ZWdyaXR5LXNoaWVsZC1zZXJ2ZXI6MC4xLjMKICAgICAgICAgICAgICAgICAgYWZmaW5pdHk6IHt9CiAgICAgICAgICAgICAgICAgIHNoaWVsZENvbmZpZzoKICAgICAgICAgICAgICAgICAgICB2ZXJpZnlUeXBlOiBwZ3AgIyB4NTA5CiAgICAgICAgICAgICAgICAgICAgaVNoaWVsZEFkbWluVXNlck5hbWU6ICJzeXN0ZW06c2VydmljZWFjY291bnQ6b3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQtYWdlbnQtYWRkb246a2x1c3RlcmxldC1hZGRvbi1wb2xpY3ljdHJsIgogICAgICAgICAgICAgICAgICAgIGluU2NvcGVOYW1lc3BhY2VTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgIGluY2x1ZGU6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gIioiCiAgICAgICAgICAgICAgICAgICAgICBleGNsdWRlOgogICAgICAgICAgICAgICAgICAgICAgICAtICJrdWJlLSoiCiAgICAgICAgICAgICAgICAgICAgICAgIC0gIm9wZW5zaGlmdC0qIgogICAgICAgICAgICAgICAgICBzaWduZXJDb25maWc6CiAgICAgICAgICAgICAgICAgICAgcG9saWNpZXM6CiAgICAgICAgICAgICAgICAgICAgICAtIG5hbWVzcGFjZXM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgLSAiKiIKICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICJTYW1wbGVTaWduZXIiCiAgICAgICAgICAgICAgICAgICAgICAtIHNjb3BlOiAiQ2x1c3RlciIKICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAtICJTYW1wbGVTaWduZXIiCiAgICAgICAgICAgICAgICAgICAgc2lnbmVyczoKICAgICAgICAgICAgICAgICAgICAgIC0gbmFtZTogIlNhbXBsZVNpZ25lciIKICAgICAgICAgICAgICAgICAgICAgICAga2V5Q29uZmlnOiBzYW1wbGUtc2lnbmVyLWtleWNvbmZpZwogICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0czoKICAgICAgICAgICAgICAgICAgICAgICAgICAtIGVtYWlsOiAic2hpZWxkQHJlZGhhdC5jb20iCiAgICAgICAgICAgICAgICAgIGtleUNvbmZpZzoKICAgICAgICAgICAgICAgICAgICAtIG5hbWU6IHNhbXBsZS1zaWduZXIta2V5Y29uZmlnCiAgICAgICAgICAgICAgICAgICAgICBzZWNyZXROYW1lOiBrZXlyaW5nLXNlY3JldAogICAgICAgICAgICAgICAgICByZXNvdXJjZVNpZ25pbmdQcm9maWxlczoKICAgICAgICAgICAgICAgICAgICAtIG5hbWU6IHBvbGljeS1yc3AKICAgICAgICAgICAgICAgICAgICAgIHByb3RlY3RSdWxlczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgaWdub3JlUnVsZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gbWF0Y2g6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHVzZXJuYW1lOiAic3lzdGVtOnNlcnZpY2VhY2NvdW50Om9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LWFnZW50OioiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHVzZXJuYW1lOiAic3lzdGVtOnNlcnZpY2VhY2NvdW50Om9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LWFnZW50LWFkZG9uOioiCiAgICAgICAgICAgICAgICAgICAgICBmb3JjZUNoZWNrUnVsZXM6CiAgICAgICAgICAgICAgICAgICAgICAgIC0gbWF0Y2g6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2luZDogUG9saWN5CiAgICAgICAgICAgICAgICAgICAgICBrdXN0b21pemVQYXR0ZXJuczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBQb2xpY3kKICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lUHJlZml4OiAiKi4iCiAgICAgICAgICAgICAgICAgICAgICB1bnByb3RlY3RBdHRyczoKICAgICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gYXBpR3JvdXA6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwogICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHJzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEuYW5ub3RhdGlvbnMuXCJhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2hvc3RpbmctZGVwbG95YWJsZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEuYW5ub3RhdGlvbnMuXCJhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL2hvc3Rpbmctc3Vic2NyaXB0aW9uXCIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtICJtZXRhZGF0YS5hbm5vdGF0aW9ucy5cImFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vc3luYy1zb3VyY2VcIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmxhYmVscy5cInBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jbHVzdGVyLW5hbWVcIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gIm1ldGFkYXRhLmxhYmVscy5cInBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jbHVzdGVyLW5hbWVzcGFjZVwiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSAibWV0YWRhdGEubGFiZWxzLlwicG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3Jvb3QtcG9saWN5XCIiCiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXROYW1lc3BhY2VTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxTZWxlY3RvcjoKICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLSBrZXk6IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9pc0NsdXN0ZXJOYW1lc3BhY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlcmF0b3I6IEluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlczogWyJ0cnVlIl0KLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LWludGVncml0eS1zaGllbGQKICBhbm5vdGF0aW9uczoge30KcGxhY2VtZW50UmVmOgogIG5hbWU6IHBsYWNlbWVudC1wb2xpY3ktaW50ZWdyaXR5LXNoaWVsZAogIGtpbmQ6IFBsYWNlbWVudFJ1bGUKICBhcGlHcm91cDogYXBwcy5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pbwpzdWJqZWN0czoKICAtIG5hbWU6IHBvbGljeS1pbnRlZ3JpdHktc2hpZWxkCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LWludGVncml0eS1zaGllbGQKICBhbm5vdGF0aW9uczoge30Kc3BlYzoKICBjbHVzdGVyQ29uZGl0aW9uczoKICAgIC0gc3RhdHVzOiAiVHJ1ZSIKICAgICAgdHlwZTogTWFuYWdlZENsdXN0ZXJDb25kaXRpb25BdmFpbGFibGUKICBjbHVzdGVyU2VsZWN0b3I6CiAgICBtYXRjaEV4cHJlc3Npb25zOgogICAgICAtIHtrZXk6IGVudmlyb25tZW50LCBvcGVyYXRvcjogSW4sIHZhbHVlczogWyJkZXYiXX0K, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVpMTVNISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaVdDOE1BSkJ4Wk5SL05TM2hsRjVQSkd5M2YxQ3BRNmozcDVSNwpzTkp1eERqV3VWTnJCS1JHdUJmU1o0c3VJVmIzQjltb3I4eDFoR20ycFN5M0ovUks1VmpSWi8wbWRSbW9qYWNICjVyT0YvR3pTSDNLMGFMdHhBREFFMFIrVEtBQjREWThTUThJUkF3TGxpTm51aDNYUEV2WVB2a1p6U3BhWjE4ZkIKVklwYy9XZ2d3MDJqa1BMaW5BYmwrbmZiTTVjdERybjFCY2RPdGd2TzlmclRZTG4wOWdlWFlxY1pVb1lmbHdrNgp5MXNUOTVTRk5PVkhnK0dITTUvL2VTMjhSYVhRSmNMb045WXdSbzFYcWZHNEludWpkL2hGR0JLT2FNdHlDVjZsCmJsSVMwd1pOVEtNWm9rdzVLanI4OUU2cnJocFlrK1h2Yk82bUpBUURMVmxpcVJxaGlCaFFkelVHbEJFNDVEMDUKUTR4OG1Wcms4OVBJUUh2S25GVi9RS3hBcjc5WG0xY0FsM1NjdEFqWUlBTGdRMGFBbHNHeXNsdUZNNnZheklyTwpmMm10ejY3UU1tV0JVVmNoT05XbHlmMkpJT0l3b2R0WHk5eUxITlpuempnNFNhRlRtVXJ1ZEZqMDNDdnl5dzJmCnA2NWpUUjkrZXNFUm92QnVEdWI3WG55d3BvakRocGNSTlE9PQo9V1krMQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
