apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  name: policy-securitycontextconstraints
  annotations:
    policy.open-cluster-management.io/standards: NIST SP 800-53
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-3 Malicious Code Protection
    integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktc2VjdXJpdHljb250ZXh0Y29uc3RyYWludHMKICBhbm5vdGF0aW9uczoKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9zdGFuZGFyZHM6IE5JU1QgU1AgODAwLTUzCiAgICBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vY2F0ZWdvcmllczogU0kgU3lzdGVtIGFuZCBJbmZvcm1hdGlvbiBJbnRlZ3JpdHkKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogU0ktMyBNYWxpY2lvdXMgQ29kZSBQcm90ZWN0aW9uCnNwZWM6CiAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybQogIGRpc2FibGVkOiBmYWxzZQogIHBvbGljeS10ZW1wbGF0ZXM6CiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzLWV4YW1wbGUKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybSAjIHRoZSBwb2xpY3ktdGVtcGxhdGUgc3BlYy5yZW1lZGlhdGlvbkFjdGlvbiBpcyBvdmVycmlkZGVuIGJ5IHRoZSBwcmVjZWRpbmcgcGFyYW1ldGVyIHZhbHVlIGZvciBzcGVjLnJlbWVkaWF0aW9uQWN0aW9uLgogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICBleGNsdWRlOiBbImt1YmUtKiJdCiAgICAgICAgICAgIGluY2x1ZGU6IFsiZGVmYXVsdCJdCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBzZWN1cml0eS5vcGVuc2hpZnQuaW8vdjEKICAgICAgICAgICAgICAgIGtpbmQ6IFNlY3VyaXR5Q29udGV4dENvbnN0cmFpbnRzICMgcmVzdHJpY3RlZCBzY2MKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBhbm5vdGF0aW9uczoKICAgICAgICAgICAgICAgICAgICBrdWJlcm5ldGVzLmlvL2Rlc2NyaXB0aW9uOiByZXN0cmljdGVkIGRlbmllcyBhY2Nlc3MgdG8gYWxsIGhvc3QgZmVhdHVyZXMgYW5kIHJlcXVpcmVzIHBvZHMgdG8gYmUgcnVuIHdpdGggYSBVSUQsIGFuZCBTRUxpbnV4IGNvbnRleHQgdGhhdCBhcmUgYWxsb2NhdGVkIHRvIHRoZSBuYW1lc3BhY2UuICBUaGlzIGlzIHRoZSBtb3N0IHJlc3RyaWN0aXZlIFNDQyBhbmQgaXQgaXMgdXNlZCBieSBkZWZhdWx0IGZvciBhdXRoZW50aWNhdGVkIHVzZXJzLgogICAgICAgICAgICAgICAgICBuYW1lOiBzYW1wbGUtcmVzdHJpY3RlZC1zY2MKICAgICAgICAgICAgICAgIGFsbG93SG9zdERpclZvbHVtZVBsdWdpbjogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93SG9zdElQQzogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93SG9zdE5ldHdvcms6IGZhbHNlCiAgICAgICAgICAgICAgICBhbGxvd0hvc3RQSUQ6IGZhbHNlCiAgICAgICAgICAgICAgICBhbGxvd0hvc3RQb3J0czogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93UHJpdmlsZWdlRXNjYWxhdGlvbjogdHJ1ZQogICAgICAgICAgICAgICAgYWxsb3dQcml2aWxlZ2VkQ29udGFpbmVyOiBmYWxzZQogICAgICAgICAgICAgICAgYWxsb3dlZENhcGFiaWxpdGllczogW10KICAgICAgICAgICAgICAgIGRlZmF1bHRBZGRDYXBhYmlsaXRpZXM6IFtdCiAgICAgICAgICAgICAgICBmc0dyb3VwOgogICAgICAgICAgICAgICAgICB0eXBlOiBNdXN0UnVuQXMKICAgICAgICAgICAgICAgIGdyb3VwczoKICAgICAgICAgICAgICAgICAgLSBzeXN0ZW06YXV0aGVudGljYXRlZAogICAgICAgICAgICAgICAgcHJpb3JpdHk6IDEwCiAgICAgICAgICAgICAgICByZWFkT25seVJvb3RGaWxlc3lzdGVtOiBmYWxzZQogICAgICAgICAgICAgICAgcmVxdWlyZWREcm9wQ2FwYWJpbGl0aWVzOgogICAgICAgICAgICAgICAgICAtIEtJTEwKICAgICAgICAgICAgICAgICAgLSBNS05PRAogICAgICAgICAgICAgICAgICAtIFNFVFVJRAogICAgICAgICAgICAgICAgICAtIFNFVEdJRAogICAgICAgICAgICAgICAgcnVuQXNVc2VyOgogICAgICAgICAgICAgICAgICB0eXBlOiBNdXN0UnVuQXNSYW5nZQogICAgICAgICAgICAgICAgc2VMaW51eENvbnRleHQ6CiAgICAgICAgICAgICAgICAgIHR5cGU6IE11c3RSdW5BcwogICAgICAgICAgICAgICAgc3VwcGxlbWVudGFsR3JvdXBzOgogICAgICAgICAgICAgICAgICB0eXBlOiBSdW5Bc0FueQogICAgICAgICAgICAgICAgdXNlcnM6IFtdCiAgICAgICAgICAgICAgICB2b2x1bWVzOgogICAgICAgICAgICAgICAgICAtIGNvbmZpZ01hcAogICAgICAgICAgICAgICAgICAtIGRvd253YXJkQVBJCiAgICAgICAgICAgICAgICAgIC0gZW1wdHlEaXIKICAgICAgICAgICAgICAgICAgLSBwZXJzaXN0ZW50Vm9sdW1lQ2xhaW0KICAgICAgICAgICAgICAgICAgLSBwcm9qZWN0ZWQKICAgICAgICAgICAgICAgICAgLSBzZWNyZXQKLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgYW5ub3RhdGlvbnM6IHt9CnBsYWNlbWVudFJlZjoKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAga2luZDogUGxhY2VtZW50UnVsZQogIGFwaUdyb3VwOiBhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCnN1YmplY3RzOgogIC0gbmFtZTogcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgYW5ub3RhdGlvbnM6IHt9CnNwZWM6CiAgY2x1c3RlckNvbmRpdGlvbnM6CiAgICAtIHN0YXR1czogIlRydWUiCiAgICAgIHR5cGU6IE1hbmFnZWRDbHVzdGVyQ29uZGl0aW9uQXZhaWxhYmxlCiAgY2x1c3RlclNlbGVjdG9yOgogICAgbWF0Y2hFeHByZXNzaW9uczoKICAgICAgLSB7a2V5OiBlbnZpcm9ubWVudCwgb3BlcmF0b3I6IEluLCB2YWx1ZXM6IFsiZGV2Il19Cg==
    integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhHd1NISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaTdBRU1BSjBHWXltYWlVUE9IU3ZCRldWaUVYTFdlbDhtMFdySwpQRVR0OW96Q3BlSDgySDJnSU9EczdmWkhWVWczR3BFTVdZTmRtNDRGN0NTVXd1Vlg2N1ZRbjRkR2lXVWJBMVpvCmZEM3c2YVJvRGV2cmZyL0RrdUFjZ25XeDhCc1JDWGFkRGNSdFAxZ1NlWWJXL1RnVUxNdWh5NWx6YllPM2tTYi8KNS9tdG8xSC91M04wNWhRYjI5V3NLUytuVTM1MGh6TTMrbXVPVG56YTRlMEE2UTI1ZjVvakJ2YTcwVUpvOEVPTgo4d2hQQ1pFYk42Ti93aFA2TG9yOVh4aktkWnh5emNOVGwrcTJSVUFJazhaaXh3d01DUGpxeGhXYjR6NVhYYnpWClliYlpMN3FncVd6QndtbEZVbFJpMTQwQUNKZUhtbmNsSmV6cmpWaXlKbWlSNVBpd3hXaFVpajVUd0h6Qkh0SzMKVDRaREFqc0N3RmY2L2x5ODdiMVhrVEtCVzArOG9HUlE3K1FKMXJ5ajVhNWQ3QnNxTUhsVVhVMnBmZEhQTlVRWQozUy9sMzVhME0yaHhuRHJRd0J4b2tqZTRTSkd3UGNFU3lXMUtNMU9xa0NGbmkrV0lGamw5WTR5MXowWmQ2SWZCCmlrYyt0VzhDZFZXeHlYRmVTbFF5dkJtdlkxQnMxUVMvMGc9PQo9UTJIeQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K
spec:
  remediationAction: inform
  disabled: false
  policy-templates:
    - objectDefinition:
        apiVersion: policy.open-cluster-management.io/v1
        kind: ConfigurationPolicy
        metadata:
          name: policy-securitycontextconstraints-example
        spec:
          remediationAction: inform # the policy-template spec.remediationAction is overridden by the preceding parameter value for spec.remediationAction.
          severity: high
          namespaceSelector:
            exclude: ["kube-*"]
            include: ["default"]
          object-templates:
            - complianceType: musthave
              objectDefinition:
                apiVersion: security.openshift.io/v1
                kind: SecurityContextConstraints # restricted scc
                metadata:
                  annotations:
                    kubernetes.io/description: restricted denies access to all host features and requires pods to be run with a UID, and SELinux context that are allocated to the namespace.  This is the most restrictive SCC and it is used by default for authenticated users.
                  name: sample-restricted-scc
                allowHostDirVolumePlugin: false
                allowHostIPC: false
                allowHostNetwork: false
                allowHostPID: false
                allowHostPorts: false
                allowPrivilegeEscalation: true
                allowPrivilegedContainer: false
                allowedCapabilities: []
                defaultAddCapabilities: []
                fsGroup:
                  type: MustRunAs
                groups:
                  - system:authenticated
                priority: 10
                readOnlyRootFilesystem: false
                requiredDropCapabilities:
                  - KILL
                  - MKNOD
                  - SETUID
                  - SETGID
                runAsUser:
                  type: MustRunAsRange
                seLinuxContext:
                  type: MustRunAs
                supplementalGroups:
                  type: RunAsAny
                users: []
                volumes:
                  - configMap
                  - downwardAPI
                  - emptyDir
                  - persistentVolumeClaim
                  - projected
                  - secret
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  name: binding-policy-securitycontextconstraints
  annotations: {integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktc2VjdXJpdHljb250ZXh0Y29uc3RyYWludHMKICBhbm5vdGF0aW9uczoKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9zdGFuZGFyZHM6IE5JU1QgU1AgODAwLTUzCiAgICBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vY2F0ZWdvcmllczogU0kgU3lzdGVtIGFuZCBJbmZvcm1hdGlvbiBJbnRlZ3JpdHkKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogU0ktMyBNYWxpY2lvdXMgQ29kZSBQcm90ZWN0aW9uCnNwZWM6CiAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybQogIGRpc2FibGVkOiBmYWxzZQogIHBvbGljeS10ZW1wbGF0ZXM6CiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzLWV4YW1wbGUKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybSAjIHRoZSBwb2xpY3ktdGVtcGxhdGUgc3BlYy5yZW1lZGlhdGlvbkFjdGlvbiBpcyBvdmVycmlkZGVuIGJ5IHRoZSBwcmVjZWRpbmcgcGFyYW1ldGVyIHZhbHVlIGZvciBzcGVjLnJlbWVkaWF0aW9uQWN0aW9uLgogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICBleGNsdWRlOiBbImt1YmUtKiJdCiAgICAgICAgICAgIGluY2x1ZGU6IFsiZGVmYXVsdCJdCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBzZWN1cml0eS5vcGVuc2hpZnQuaW8vdjEKICAgICAgICAgICAgICAgIGtpbmQ6IFNlY3VyaXR5Q29udGV4dENvbnN0cmFpbnRzICMgcmVzdHJpY3RlZCBzY2MKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBhbm5vdGF0aW9uczoKICAgICAgICAgICAgICAgICAgICBrdWJlcm5ldGVzLmlvL2Rlc2NyaXB0aW9uOiByZXN0cmljdGVkIGRlbmllcyBhY2Nlc3MgdG8gYWxsIGhvc3QgZmVhdHVyZXMgYW5kIHJlcXVpcmVzIHBvZHMgdG8gYmUgcnVuIHdpdGggYSBVSUQsIGFuZCBTRUxpbnV4IGNvbnRleHQgdGhhdCBhcmUgYWxsb2NhdGVkIHRvIHRoZSBuYW1lc3BhY2UuICBUaGlzIGlzIHRoZSBtb3N0IHJlc3RyaWN0aXZlIFNDQyBhbmQgaXQgaXMgdXNlZCBieSBkZWZhdWx0IGZvciBhdXRoZW50aWNhdGVkIHVzZXJzLgogICAgICAgICAgICAgICAgICBuYW1lOiBzYW1wbGUtcmVzdHJpY3RlZC1zY2MKICAgICAgICAgICAgICAgIGFsbG93SG9zdERpclZvbHVtZVBsdWdpbjogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93SG9zdElQQzogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93SG9zdE5ldHdvcms6IGZhbHNlCiAgICAgICAgICAgICAgICBhbGxvd0hvc3RQSUQ6IGZhbHNlCiAgICAgICAgICAgICAgICBhbGxvd0hvc3RQb3J0czogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93UHJpdmlsZWdlRXNjYWxhdGlvbjogdHJ1ZQogICAgICAgICAgICAgICAgYWxsb3dQcml2aWxlZ2VkQ29udGFpbmVyOiBmYWxzZQogICAgICAgICAgICAgICAgYWxsb3dlZENhcGFiaWxpdGllczogW10KICAgICAgICAgICAgICAgIGRlZmF1bHRBZGRDYXBhYmlsaXRpZXM6IFtdCiAgICAgICAgICAgICAgICBmc0dyb3VwOgogICAgICAgICAgICAgICAgICB0eXBlOiBNdXN0UnVuQXMKICAgICAgICAgICAgICAgIGdyb3VwczoKICAgICAgICAgICAgICAgICAgLSBzeXN0ZW06YXV0aGVudGljYXRlZAogICAgICAgICAgICAgICAgcHJpb3JpdHk6IDEwCiAgICAgICAgICAgICAgICByZWFkT25seVJvb3RGaWxlc3lzdGVtOiBmYWxzZQogICAgICAgICAgICAgICAgcmVxdWlyZWREcm9wQ2FwYWJpbGl0aWVzOgogICAgICAgICAgICAgICAgICAtIEtJTEwKICAgICAgICAgICAgICAgICAgLSBNS05PRAogICAgICAgICAgICAgICAgICAtIFNFVFVJRAogICAgICAgICAgICAgICAgICAtIFNFVEdJRAogICAgICAgICAgICAgICAgcnVuQXNVc2VyOgogICAgICAgICAgICAgICAgICB0eXBlOiBNdXN0UnVuQXNSYW5nZQogICAgICAgICAgICAgICAgc2VMaW51eENvbnRleHQ6CiAgICAgICAgICAgICAgICAgIHR5cGU6IE11c3RSdW5BcwogICAgICAgICAgICAgICAgc3VwcGxlbWVudGFsR3JvdXBzOgogICAgICAgICAgICAgICAgICB0eXBlOiBSdW5Bc0FueQogICAgICAgICAgICAgICAgdXNlcnM6IFtdCiAgICAgICAgICAgICAgICB2b2x1bWVzOgogICAgICAgICAgICAgICAgICAtIGNvbmZpZ01hcAogICAgICAgICAgICAgICAgICAtIGRvd253YXJkQVBJCiAgICAgICAgICAgICAgICAgIC0gZW1wdHlEaXIKICAgICAgICAgICAgICAgICAgLSBwZXJzaXN0ZW50Vm9sdW1lQ2xhaW0KICAgICAgICAgICAgICAgICAgLSBwcm9qZWN0ZWQKICAgICAgICAgICAgICAgICAgLSBzZWNyZXQKLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgYW5ub3RhdGlvbnM6IHt9CnBsYWNlbWVudFJlZjoKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAga2luZDogUGxhY2VtZW50UnVsZQogIGFwaUdyb3VwOiBhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCnN1YmplY3RzOgogIC0gbmFtZTogcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgYW5ub3RhdGlvbnM6IHt9CnNwZWM6CiAgY2x1c3RlckNvbmRpdGlvbnM6CiAgICAtIHN0YXR1czogIlRydWUiCiAgICAgIHR5cGU6IE1hbmFnZWRDbHVzdGVyQ29uZGl0aW9uQXZhaWxhYmxlCiAgY2x1c3RlclNlbGVjdG9yOgogICAgbWF0Y2hFeHByZXNzaW9uczoKICAgICAgLSB7a2V5OiBlbnZpcm9ubWVudCwgb3BlcmF0b3I6IEluLCB2YWx1ZXM6IFsiZGV2Il19Cg==, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhHd1NISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaTdBRU1BSjBHWXltYWlVUE9IU3ZCRldWaUVYTFdlbDhtMFdySwpQRVR0OW96Q3BlSDgySDJnSU9EczdmWkhWVWczR3BFTVdZTmRtNDRGN0NTVXd1Vlg2N1ZRbjRkR2lXVWJBMVpvCmZEM3c2YVJvRGV2cmZyL0RrdUFjZ25XeDhCc1JDWGFkRGNSdFAxZ1NlWWJXL1RnVUxNdWh5NWx6YllPM2tTYi8KNS9tdG8xSC91M04wNWhRYjI5V3NLUytuVTM1MGh6TTMrbXVPVG56YTRlMEE2UTI1ZjVvakJ2YTcwVUpvOEVPTgo4d2hQQ1pFYk42Ti93aFA2TG9yOVh4aktkWnh5emNOVGwrcTJSVUFJazhaaXh3d01DUGpxeGhXYjR6NVhYYnpWClliYlpMN3FncVd6QndtbEZVbFJpMTQwQUNKZUhtbmNsSmV6cmpWaXlKbWlSNVBpd3hXaFVpajVUd0h6Qkh0SzMKVDRaREFqc0N3RmY2L2x5ODdiMVhrVEtCVzArOG9HUlE3K1FKMXJ5ajVhNWQ3QnNxTUhsVVhVMnBmZEhQTlVRWQozUy9sMzVhME0yaHhuRHJRd0J4b2tqZTRTSkd3UGNFU3lXMUtNMU9xa0NGbmkrV0lGamw5WTR5MXowWmQ2SWZCCmlrYyt0VzhDZFZXeHlYRmVTbFF5dkJtdlkxQnMxUVMvMGc9PQo9UTJIeQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
placementRef:
  name: placement-policy-securitycontextconstraints
  kind: PlacementRule
  apiGroup: apps.open-cluster-management.io
subjects:
  - name: policy-securitycontextconstraints
    kind: Policy
    apiGroup: policy.open-cluster-management.io
---
apiVersion: apps.open-cluster-management.io/v1
kind: PlacementRule
metadata:
  name: placement-policy-securitycontextconstraints
  annotations: {integrityshield.io/message: YXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCmtpbmQ6IFBvbGljeQptZXRhZGF0YToKICBuYW1lOiBwb2xpY3ktc2VjdXJpdHljb250ZXh0Y29uc3RyYWludHMKICBhbm5vdGF0aW9uczoKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9zdGFuZGFyZHM6IE5JU1QgU1AgODAwLTUzCiAgICBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vY2F0ZWdvcmllczogU0kgU3lzdGVtIGFuZCBJbmZvcm1hdGlvbiBJbnRlZ3JpdHkKICAgIHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby9jb250cm9sczogU0ktMyBNYWxpY2lvdXMgQ29kZSBQcm90ZWN0aW9uCnNwZWM6CiAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybQogIGRpc2FibGVkOiBmYWxzZQogIHBvbGljeS10ZW1wbGF0ZXM6CiAgICAtIG9iamVjdERlZmluaXRpb246CiAgICAgICAgYXBpVmVyc2lvbjogcG9saWN5Lm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvL3YxCiAgICAgICAga2luZDogQ29uZmlndXJhdGlvblBvbGljeQogICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgbmFtZTogcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzLWV4YW1wbGUKICAgICAgICBzcGVjOgogICAgICAgICAgcmVtZWRpYXRpb25BY3Rpb246IGluZm9ybSAjIHRoZSBwb2xpY3ktdGVtcGxhdGUgc3BlYy5yZW1lZGlhdGlvbkFjdGlvbiBpcyBvdmVycmlkZGVuIGJ5IHRoZSBwcmVjZWRpbmcgcGFyYW1ldGVyIHZhbHVlIGZvciBzcGVjLnJlbWVkaWF0aW9uQWN0aW9uLgogICAgICAgICAgc2V2ZXJpdHk6IGhpZ2gKICAgICAgICAgIG5hbWVzcGFjZVNlbGVjdG9yOgogICAgICAgICAgICBleGNsdWRlOiBbImt1YmUtKiJdCiAgICAgICAgICAgIGluY2x1ZGU6IFsiZGVmYXVsdCJdCiAgICAgICAgICBvYmplY3QtdGVtcGxhdGVzOgogICAgICAgICAgICAtIGNvbXBsaWFuY2VUeXBlOiBtdXN0aGF2ZQogICAgICAgICAgICAgIG9iamVjdERlZmluaXRpb246CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiBzZWN1cml0eS5vcGVuc2hpZnQuaW8vdjEKICAgICAgICAgICAgICAgIGtpbmQ6IFNlY3VyaXR5Q29udGV4dENvbnN0cmFpbnRzICMgcmVzdHJpY3RlZCBzY2MKICAgICAgICAgICAgICAgIG1ldGFkYXRhOgogICAgICAgICAgICAgICAgICBhbm5vdGF0aW9uczoKICAgICAgICAgICAgICAgICAgICBrdWJlcm5ldGVzLmlvL2Rlc2NyaXB0aW9uOiByZXN0cmljdGVkIGRlbmllcyBhY2Nlc3MgdG8gYWxsIGhvc3QgZmVhdHVyZXMgYW5kIHJlcXVpcmVzIHBvZHMgdG8gYmUgcnVuIHdpdGggYSBVSUQsIGFuZCBTRUxpbnV4IGNvbnRleHQgdGhhdCBhcmUgYWxsb2NhdGVkIHRvIHRoZSBuYW1lc3BhY2UuICBUaGlzIGlzIHRoZSBtb3N0IHJlc3RyaWN0aXZlIFNDQyBhbmQgaXQgaXMgdXNlZCBieSBkZWZhdWx0IGZvciBhdXRoZW50aWNhdGVkIHVzZXJzLgogICAgICAgICAgICAgICAgICBuYW1lOiBzYW1wbGUtcmVzdHJpY3RlZC1zY2MKICAgICAgICAgICAgICAgIGFsbG93SG9zdERpclZvbHVtZVBsdWdpbjogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93SG9zdElQQzogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93SG9zdE5ldHdvcms6IGZhbHNlCiAgICAgICAgICAgICAgICBhbGxvd0hvc3RQSUQ6IGZhbHNlCiAgICAgICAgICAgICAgICBhbGxvd0hvc3RQb3J0czogZmFsc2UKICAgICAgICAgICAgICAgIGFsbG93UHJpdmlsZWdlRXNjYWxhdGlvbjogdHJ1ZQogICAgICAgICAgICAgICAgYWxsb3dQcml2aWxlZ2VkQ29udGFpbmVyOiBmYWxzZQogICAgICAgICAgICAgICAgYWxsb3dlZENhcGFiaWxpdGllczogW10KICAgICAgICAgICAgICAgIGRlZmF1bHRBZGRDYXBhYmlsaXRpZXM6IFtdCiAgICAgICAgICAgICAgICBmc0dyb3VwOgogICAgICAgICAgICAgICAgICB0eXBlOiBNdXN0UnVuQXMKICAgICAgICAgICAgICAgIGdyb3VwczoKICAgICAgICAgICAgICAgICAgLSBzeXN0ZW06YXV0aGVudGljYXRlZAogICAgICAgICAgICAgICAgcHJpb3JpdHk6IDEwCiAgICAgICAgICAgICAgICByZWFkT25seVJvb3RGaWxlc3lzdGVtOiBmYWxzZQogICAgICAgICAgICAgICAgcmVxdWlyZWREcm9wQ2FwYWJpbGl0aWVzOgogICAgICAgICAgICAgICAgICAtIEtJTEwKICAgICAgICAgICAgICAgICAgLSBNS05PRAogICAgICAgICAgICAgICAgICAtIFNFVFVJRAogICAgICAgICAgICAgICAgICAtIFNFVEdJRAogICAgICAgICAgICAgICAgcnVuQXNVc2VyOgogICAgICAgICAgICAgICAgICB0eXBlOiBNdXN0UnVuQXNSYW5nZQogICAgICAgICAgICAgICAgc2VMaW51eENvbnRleHQ6CiAgICAgICAgICAgICAgICAgIHR5cGU6IE11c3RSdW5BcwogICAgICAgICAgICAgICAgc3VwcGxlbWVudGFsR3JvdXBzOgogICAgICAgICAgICAgICAgICB0eXBlOiBSdW5Bc0FueQogICAgICAgICAgICAgICAgdXNlcnM6IFtdCiAgICAgICAgICAgICAgICB2b2x1bWVzOgogICAgICAgICAgICAgICAgICAtIGNvbmZpZ01hcAogICAgICAgICAgICAgICAgICAtIGRvd253YXJkQVBJCiAgICAgICAgICAgICAgICAgIC0gZW1wdHlEaXIKICAgICAgICAgICAgICAgICAgLSBwZXJzaXN0ZW50Vm9sdW1lQ2xhaW0KICAgICAgICAgICAgICAgICAgLSBwcm9qZWN0ZWQKICAgICAgICAgICAgICAgICAgLSBzZWNyZXQKLS0tCmFwaVZlcnNpb246IHBvbGljeS5vcGVuLWNsdXN0ZXItbWFuYWdlbWVudC5pby92MQpraW5kOiBQbGFjZW1lbnRCaW5kaW5nCm1ldGFkYXRhOgogIG5hbWU6IGJpbmRpbmctcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgYW5ub3RhdGlvbnM6IHt9CnBsYWNlbWVudFJlZjoKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAga2luZDogUGxhY2VtZW50UnVsZQogIGFwaUdyb3VwOiBhcHBzLm9wZW4tY2x1c3Rlci1tYW5hZ2VtZW50LmlvCnN1YmplY3RzOgogIC0gbmFtZTogcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgICBraW5kOiBQb2xpY3kKICAgIGFwaUdyb3VwOiBwb2xpY3kub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8KLS0tCmFwaVZlcnNpb246IGFwcHMub3Blbi1jbHVzdGVyLW1hbmFnZW1lbnQuaW8vdjEKa2luZDogUGxhY2VtZW50UnVsZQptZXRhZGF0YToKICBuYW1lOiBwbGFjZW1lbnQtcG9saWN5LXNlY3VyaXR5Y29udGV4dGNvbnN0cmFpbnRzCiAgYW5ub3RhdGlvbnM6IHt9CnNwZWM6CiAgY2x1c3RlckNvbmRpdGlvbnM6CiAgICAtIHN0YXR1czogIlRydWUiCiAgICAgIHR5cGU6IE1hbmFnZWRDbHVzdGVyQ29uZGl0aW9uQXZhaWxhYmxlCiAgY2x1c3RlclNlbGVjdG9yOgogICAgbWF0Y2hFeHByZXNzaW9uczoKICAgICAgLSB7a2V5OiBlbnZpcm9ubWVudCwgb3BlcmF0b3I6IEluLCB2YWx1ZXM6IFsiZGV2Il19Cg==, integrityshield.io/signature: LS0tLS1CRUdJTiBQR1AgU0lHTkFUVVJFLS0tLS0KCmlRSEdCQUFCQ0FBd0ZpRUVJbnBMR1hSY1QwV2tWTzgyVSt5TUt1c3JLdUlGQW1BSVhHd1NISE5vYVdWc1pFQnkKWldSb1lYUXVZMjl0QUFvSkVGUHNqQ3JyS3lyaTdBRU1BSjBHWXltYWlVUE9IU3ZCRldWaUVYTFdlbDhtMFdySwpQRVR0OW96Q3BlSDgySDJnSU9EczdmWkhWVWczR3BFTVdZTmRtNDRGN0NTVXd1Vlg2N1ZRbjRkR2lXVWJBMVpvCmZEM3c2YVJvRGV2cmZyL0RrdUFjZ25XeDhCc1JDWGFkRGNSdFAxZ1NlWWJXL1RnVUxNdWh5NWx6YllPM2tTYi8KNS9tdG8xSC91M04wNWhRYjI5V3NLUytuVTM1MGh6TTMrbXVPVG56YTRlMEE2UTI1ZjVvakJ2YTcwVUpvOEVPTgo4d2hQQ1pFYk42Ti93aFA2TG9yOVh4aktkWnh5emNOVGwrcTJSVUFJazhaaXh3d01DUGpxeGhXYjR6NVhYYnpWClliYlpMN3FncVd6QndtbEZVbFJpMTQwQUNKZUhtbmNsSmV6cmpWaXlKbWlSNVBpd3hXaFVpajVUd0h6Qkh0SzMKVDRaREFqc0N3RmY2L2x5ODdiMVhrVEtCVzArOG9HUlE3K1FKMXJ5ajVhNWQ3QnNxTUhsVVhVMnBmZEhQTlVRWQozUy9sMzVhME0yaHhuRHJRd0J4b2tqZTRTSkd3UGNFU3lXMUtNMU9xa0NGbmkrV0lGamw5WTR5MXowWmQ2SWZCCmlrYyt0VzhDZFZXeHlYRmVTbFF5dkJtdlkxQnMxUVMvMGc9PQo9UTJIeQotLS0tLUVORCBQR1AgU0lHTkFUVVJFLS0tLS0K}
spec:
  clusterConditions:
    - status: "True"
      type: ManagedClusterConditionAvailable
  clusterSelector:
    matchExpressions:
      - {key: environment, operator: In, values: ["dev"]}
